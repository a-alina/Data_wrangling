2021-10-04 15:34:23.818649 (MainThread): Running with dbt=0.19.0
2021-10-04 15:34:23.950294 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 15:34:23.958044 (MainThread): Tracking: tracking
2021-10-04 15:34:23.961464 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec6fa9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec8a54310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec6fbb1c0>]}
2021-10-04 15:34:24.025737 (MainThread): Partial parsing not enabled
2021-10-04 15:34:24.031656 (MainThread): Parsing macros/adapters.sql
2021-10-04 15:34:24.085326 (MainThread): Parsing macros/catalog.sql
2021-10-04 15:34:24.091557 (MainThread): Parsing macros/relations.sql
2021-10-04 15:34:24.095696 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 15:34:24.104318 (MainThread): Parsing macros/core.sql
2021-10-04 15:34:24.115365 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 15:34:24.241933 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 15:34:24.245882 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 15:34:24.249191 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 15:34:24.266258 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 15:34:24.269538 (MainThread): Parsing macros/etc/query.sql
2021-10-04 15:34:24.271734 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 15:34:24.273638 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 15:34:24.290202 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 15:34:24.330190 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 15:34:24.333728 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 15:34:24.396971 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 15:34:24.433147 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 15:34:24.444641 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 15:34:24.448498 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 15:34:24.476302 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 15:34:24.485758 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 15:34:24.498053 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 15:34:24.510637 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 15:34:24.513960 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 15:34:24.516856 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 15:34:24.520444 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 15:34:24.540936 (MainThread): Partial parsing not enabled
2021-10-04 15:34:24.612764 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 15:34:24.664327 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:34:24.695275 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:34:24.978383 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70c3e51a-a99a-4eb2-864c-b28169641815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec6e7d1c0>]}
2021-10-04 15:34:25.049630 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-04 15:34:25.051583 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-04 15:34:25.054087 (MainThread): 
2021-10-04 15:34:25.055535 (MainThread): Acquiring new postgres connection "master".
2021-10-04 15:34:25.067782 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-04 15:34:25.088832 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-04 15:34:25.089602 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-04 15:34:25.090402 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-04 15:34:25.101096 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-04 15:34:25.111480 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-04 15:34:25.119053 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-04 15:34:25.129480 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 15:34:25.130204 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-04 15:34:25.130790 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-04 15:34:25.135408 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:34:25.136012 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 15:34:25.136508 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-04 15:34:25.140184 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-04 15:34:25.155866 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-04 15:34:25.156883 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-04 15:34:25.171541 (MainThread): Using postgres connection "master".
2021-10-04 15:34:25.172272 (MainThread): On master: BEGIN
2021-10-04 15:34:25.172833 (MainThread): Opening a new connection, currently in state init
2021-10-04 15:34:25.178483 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-04 15:34:25.179167 (MainThread): Using postgres connection "master".
2021-10-04 15:34:25.179763 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-04 15:34:25.189748 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-04 15:34:25.190941 (MainThread): On master: ROLLBACK
2021-10-04 15:34:25.191954 (MainThread): Using postgres connection "master".
2021-10-04 15:34:25.192566 (MainThread): On master: BEGIN
2021-10-04 15:34:25.193696 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:34:25.194379 (MainThread): On master: COMMIT
2021-10-04 15:34:25.195063 (MainThread): Using postgres connection "master".
2021-10-04 15:34:25.195754 (MainThread): On master: COMMIT
2021-10-04 15:34:25.196809 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 15:34:25.197381 (MainThread): On master: Close
2021-10-04 15:34:25.198325 (MainThread): 15:34:25 | Concurrency: 2 threads (target='dev')
2021-10-04 15:34:25.199019 (MainThread): 15:34:25 | 
2021-10-04 15:34:25.216601 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-10-04 15:34:25.216922 (Thread-2): Began running node model.my_new_project.actors
2021-10-04 15:34:25.218578 (Thread-1): 15:34:25 | 1 of 3 START table model public.my_first_dbt_model................... [RUN]
2021-10-04 15:34:25.220401 (Thread-2): 15:34:25 | 2 of 3 START table model public.actors............................... [RUN]
2021-10-04 15:34:25.221641 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:34:25.223300 (Thread-2): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 15:34:25.224621 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-10-04 15:34:25.225423 (Thread-2): Compiling model.my_new_project.actors
2021-10-04 15:34:25.272520 (Thread-2): Writing injected SQL for node "model.my_new_project.actors"
2021-10-04 15:34:25.267672 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-04 15:34:25.282770 (Thread-2): finished collecting timing info
2021-10-04 15:34:25.311456 (Thread-1): finished collecting timing info
2021-10-04 15:34:25.325949 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 15:34:25.330334 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:34:25.330613 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop table if exists "dellstore"."public"."actors__dbt_tmp" cascade
2021-10-04 15:34:25.331373 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_tmp" cascade
2021-10-04 15:34:25.332010 (Thread-2): Opening a new connection, currently in state init
2021-10-04 15:34:25.332646 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 15:34:25.337568 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2021-10-04 15:34:25.337853 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-04 15:34:25.341519 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 15:34:25.344849 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:34:25.345549 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop table if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-04 15:34:25.346177 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-04 15:34:25.347157 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-04 15:34:25.347656 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-04 15:34:25.367872 (Thread-2): Writing runtime SQL for node "model.my_new_project.actors"
2021-10-04 15:34:25.368284 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-04 15:34:25.378579 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 15:34:25.379134 (Thread-2): On model.my_new_project.actors: BEGIN
2021-10-04 15:34:25.380099 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:34:25.380680 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 15:34:25.381134 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */


  create  table "dellstore"."public"."actors__dbt_tmp"
  as (
    

SELECT nested.first_name, nested.movie_number, nested.movie_prices FROM (
SELECT actor, SUBSTRING(actor, 1, POSITION(' ' in actor)) as first_name, 
actor, COUNT(*) as movie_number,
actor, SUM(price) as movie_prices
FROM "dellstore"."public"."products" 
GROUP BY actor
) nested

ORDER BY movie_prices DESC
  );
2021-10-04 15:34:25.385744 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:34:25.386500 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-10-04 15:34:25.387393 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:34:25.387891 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:34:25.388311 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "dellstore"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-10-04 15:34:25.390533 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-10-04 15:34:25.401521 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:34:25.402013 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-10-04 15:34:25.403253 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 15:34:25.414143 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-04 15:34:25.414922 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:34:25.415550 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-04 15:34:25.419343 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-04 15:34:25.425545 (Thread-2): SQL status: SELECT 8802 in 0.04 seconds
2021-10-04 15:34:25.426555 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:34:25.429622 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 15:34:25.430359 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-04 15:34:25.431093 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors__dbt_tmp" rename to "actors"
2021-10-04 15:34:25.432139 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-04 15:34:25.436048 (Thread-1): finished collecting timing info
2021-10-04 15:34:25.436411 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 15:34:25.436790 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-10-04 15:34:25.438423 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-04 15:34:25.439804 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70c3e51a-a99a-4eb2-864c-b28169641815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec64f96a0>]}
2021-10-04 15:34:25.440000 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 15:34:25.442052 (Thread-1): 15:34:25 | 1 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.22s]
2021-10-04 15:34:25.442733 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-04 15:34:25.443539 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-10-04 15:34:25.445156 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-10-04 15:34:25.447621 (Thread-1): 15:34:25 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2021-10-04 15:34:25.448646 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:34:25.449220 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-10-04 15:34:25.456524 (Thread-2): SQL status: COMMIT in 0.01 seconds
2021-10-04 15:34:25.464598 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 15:34:25.466955 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-04 15:34:25.467161 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop table if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-04 15:34:25.468555 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-04 15:34:25.475143 (Thread-2): finished collecting timing info
2021-10-04 15:34:25.476154 (Thread-2): On model.my_new_project.actors: Close
2021-10-04 15:34:25.477673 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70c3e51a-a99a-4eb2-864c-b28169641815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec6f0dfa0>]}
2021-10-04 15:34:25.479801 (Thread-2): 15:34:25 | 2 of 3 OK created table model public.actors.......................... [SELECT 8802 in 0.25s]
2021-10-04 15:34:25.480397 (Thread-2): Finished running node model.my_new_project.actors
2021-10-04 15:34:25.484015 (Thread-1): finished collecting timing info
2021-10-04 15:34:25.520507 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:34:25.521413 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_tmp" cascade
2021-10-04 15:34:25.522368 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 15:34:25.526920 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 15:34:25.530567 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:34:25.531059 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-04 15:34:25.531850 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 15:34:25.539343 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-04 15:34:25.550192 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:34:25.550691 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-10-04 15:34:25.551414 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:34:25.551885 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:34:25.552339 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "dellstore"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dellstore"."public"."my_first_dbt_model"
where id = 1
  );

2021-10-04 15:34:25.555976 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-10-04 15:34:25.560599 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:34:25.561303 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "dellstore"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-10-04 15:34:25.562497 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 15:34:25.564643 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-04 15:34:25.565216 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:34:25.565693 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-04 15:34:25.568918 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-04 15:34:25.572679 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:34:25.573292 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-04 15:34:25.574072 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 15:34:25.578010 (Thread-1): finished collecting timing info
2021-10-04 15:34:25.578948 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-10-04 15:34:25.580243 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70c3e51a-a99a-4eb2-864c-b28169641815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec6f45730>]}
2021-10-04 15:34:25.582230 (Thread-1): 15:34:25 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.13s]
2021-10-04 15:34:25.582792 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-10-04 15:34:25.585680 (MainThread): Acquiring new postgres connection "master".
2021-10-04 15:34:25.586481 (MainThread): Using postgres connection "master".
2021-10-04 15:34:25.587208 (MainThread): On master: BEGIN
2021-10-04 15:34:25.588001 (MainThread): Opening a new connection, currently in state closed
2021-10-04 15:34:25.596682 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-04 15:34:25.597348 (MainThread): On master: COMMIT
2021-10-04 15:34:25.597972 (MainThread): Using postgres connection "master".
2021-10-04 15:34:25.598761 (MainThread): On master: COMMIT
2021-10-04 15:34:25.599767 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 15:34:25.600445 (MainThread): On master: Close
2021-10-04 15:34:25.601781 (MainThread): 15:34:25 | 
2021-10-04 15:34:25.602750 (MainThread): 15:34:25 | Finished running 2 table models, 1 view model in 0.55s.
2021-10-04 15:34:25.603693 (MainThread): Connection 'master' was properly closed.
2021-10-04 15:34:25.604616 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-10-04 15:34:25.605785 (MainThread): Connection 'model.my_new_project.actors' was properly closed.
2021-10-04 15:34:25.678247 (MainThread): 
2021-10-04 15:34:25.678901 (MainThread): Completed successfully
2021-10-04 15:34:25.679574 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-04 15:34:25.680739 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec6fa9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec6e06ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec6e084c0>]}
2021-10-04 15:34:25.681910 (MainThread): Flushing usage events
2021-10-04 15:38:52.660051 (MainThread): Running with dbt=0.19.0
2021-10-04 15:38:52.788105 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-04 15:38:52.793695 (MainThread): Tracking: tracking
2021-10-04 15:38:52.797124 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50687907f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f506bd97400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50687a1220>]}
2021-10-04 15:38:52.843540 (MainThread): Partial parsing not enabled
2021-10-04 15:38:52.847932 (MainThread): Parsing macros/adapters.sql
2021-10-04 15:38:52.888306 (MainThread): Parsing macros/catalog.sql
2021-10-04 15:38:52.893285 (MainThread): Parsing macros/relations.sql
2021-10-04 15:38:52.896445 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 15:38:52.900950 (MainThread): Parsing macros/core.sql
2021-10-04 15:38:52.908507 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 15:38:52.993711 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 15:38:52.997624 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 15:38:53.000999 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 15:38:53.018950 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 15:38:53.022138 (MainThread): Parsing macros/etc/query.sql
2021-10-04 15:38:53.024213 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 15:38:53.026106 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 15:38:53.042865 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 15:38:53.082574 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 15:38:53.086275 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 15:38:53.160754 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 15:38:53.197733 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 15:38:53.209351 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 15:38:53.213193 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 15:38:53.240952 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 15:38:53.250287 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 15:38:53.262219 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 15:38:53.274708 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 15:38:53.277934 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 15:38:53.280797 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 15:38:53.284271 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 15:38:53.304765 (MainThread): Partial parsing not enabled
2021-10-04 15:38:53.372842 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 15:38:53.412667 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:38:53.437686 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:38:53.480481 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:38:53.496341 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f506875af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50685d3af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50685e4ca0>]}
2021-10-04 15:38:53.497075 (MainThread): Flushing usage events
2021-10-04 15:38:54.179478 (MainThread): Connection 'snapshot.my_new_project.actors_snapshot' was properly closed.
2021-10-04 15:38:54.180580 (MainThread): Encountered an error:
2021-10-04 15:38:54.181100 (MainThread): Compilation Error in snapshot actors_snapshot (snapshots/actors.sql)
  at path []: 'check_cols' is a required property
2021-10-04 15:38:54.193088 (MainThread): jsonschema.exceptions.ValidationError: 'check_cols' is a required property

Failed validating 'required' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': True,
     'definitions': {'Hook': {'additionalProperties': False,
                              'description': 'Hook(sql: str, transaction: '
                                             'bool = True, index: '
                                             'Union[int, NoneType] = None)',
                              'properties': {'index': {'oneOf': [{'type': 'integer'},
                                                                 {'type': 'null'}]},
                                             'sql': {'type': 'string'},
                                             'transaction': {'default': True,
                                                             'type': 'boolean'}},
                              'required': ['sql'],
                              'type': 'object'}},
     'description': 'CheckSnapshotConfig(*args, **kwds)',
     'properties': {'alias': {'oneOf': [{'type': 'string'},
                                        {'type': 'null'}]},
                    'check_cols': {'oneOf': [{'enum': ['all'],
                                              'type': 'string'},
                                             {'items': {'type': 'string'},
                                              'type': 'array'}]},
                    'column_types': {'default': {}, 'type': 'object'},
                    'database': {'oneOf': [{'type': 'string'},
                                           {'type': 'null'}]},
                    'enabled': {'default': True, 'type': 'boolean'},
                    'full_refresh': {'oneOf': [{'type': 'boolean'},
                                               {'type': 'null'}]},
                    'materialized': {'default': 'snapshot',
                                     'type': 'string'},
                    'persist_docs': {'default': {}, 'type': 'object'},
                    'post-hook': {'default': [],
                                  'items': {'$ref': '#/definitions/Hook'},
                                  'type': 'array'},
                    'pre-hook': {'default': [],
                                 'items': {'$ref': '#/definitions/Hook'},
                                 'type': 'array'},
                    'quoting': {'default': {}, 'type': 'object'},
                    'schema': {'oneOf': [{'type': 'string'},
                                         {'type': 'null'}]},
                    'strategy': {'enum': ['check'], 'type': 'string'},
                    'tags': {'default': [],
                             'oneOf': [{'items': {'type': 'string'},
                                        'type': 'array'},
                                       {'type': 'string'}]},
                    'target_database': {'oneOf': [{'type': 'string'},
                                                  {'type': 'null'}]},
                    'target_schema': {'type': 'string'},
                    'unique_key': {'type': 'string'},
                    'vars': {'default': {}, 'type': 'object'}},
     'required': ['unique_key', 'target_schema', 'strategy', 'check_cols'],
     'type': 'object'}

On instance:
    {'check_col': ['movie_number', 'movie_prices'],
     'column_types': {},
     'enabled': True,
     'materialized': 'snapshot',
     'persist_docs': {},
     'post-hook': [],
     'pre-hook': [],
     'quoting': {},
     'strategy': 'check',
     'tags': [],
     'target_database': 'dellstore',
     'target_schema': 'public',
     'unique_key': 'id',
     'vars': {}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 373, in render_update
    self.update_parsed_node(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 316, in update_parsed_node
    config_dict = config.build_config_dict()
  File "/usr/local/lib/python3.8/site-packages/dbt/context/context_config.py", line 270, in build_config_dict
    return src.calculate_node_config_dict(
  File "/usr/local/lib/python3.8/site-packages/dbt/context/context_config.py", line 198, in calculate_node_config_dict
    finalized = config.finalize_and_validate()
  File "/usr/local/lib/python3.8/site-packages/dbt/contracts/graph/model_config.py", line 552, in finalize_and_validate
    return SnapshotWrapper.from_dict({'config': data}).config
  File "/usr/local/lib/python3.8/site-packages/hologram/__init__.py", line 624, in from_dict
    cls.validate(data)
  File "/usr/local/lib/python3.8/site-packages/dbt/contracts/graph/model_config.py", line 508, in validate
    raise ValidationError.create_from(error) from error
hologram.ValidationError: 'check_cols' is a required property

Failed validating 'required' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': True,
     'definitions': {'Hook': {'additionalProperties': False,
                              'description': 'Hook(sql: str, transaction: '
                                             'bool = True, index: '
                                             'Union[int, NoneType] = None)',
                              'properties': {'index': {'oneOf': [{'type': 'integer'},
                                                                 {'type': 'null'}]},
                                             'sql': {'type': 'string'},
                                             'transaction': {'default': True,
                                                             'type': 'boolean'}},
                              'required': ['sql'],
                              'type': 'object'}},
     'description': 'CheckSnapshotConfig(*args, **kwds)',
     'properties': {'alias': {'oneOf': [{'type': 'string'},
                                        {'type': 'null'}]},
                    'check_cols': {'oneOf': [{'enum': ['all'],
                                              'type': 'string'},
                                             {'items': {'type': 'string'},
                                              'type': 'array'}]},
                    'column_types': {'default': {}, 'type': 'object'},
                    'database': {'oneOf': [{'type': 'string'},
                                           {'type': 'null'}]},
                    'enabled': {'default': True, 'type': 'boolean'},
                    'full_refresh': {'oneOf': [{'type': 'boolean'},
                                               {'type': 'null'}]},
                    'materialized': {'default': 'snapshot',
                                     'type': 'string'},
                    'persist_docs': {'default': {}, 'type': 'object'},
                    'post-hook': {'default': [],
                                  'items': {'$ref': '#/definitions/Hook'},
                                  'type': 'array'},
                    'pre-hook': {'default': [],
                                 'items': {'$ref': '#/definitions/Hook'},
                                 'type': 'array'},
                    'quoting': {'default': {}, 'type': 'object'},
                    'schema': {'oneOf': [{'type': 'string'},
                                         {'type': 'null'}]},
                    'strategy': {'enum': ['check'], 'type': 'string'},
                    'tags': {'default': [],
                             'oneOf': [{'items': {'type': 'string'},
                                        'type': 'array'},
                                       {'type': 'string'}]},
                    'target_database': {'oneOf': [{'type': 'string'},
                                                  {'type': 'null'}]},
                    'target_schema': {'type': 'string'},
                    'unique_key': {'type': 'string'},
                    'vars': {'default': {}, 'type': 'object'}},
     'required': ['unique_key', 'target_schema', 'strategy', 'check_cols'],
     'type': 'object'}

On instance:
    {'check_col': ['movie_number', 'movie_prices'],
     'column_types': {},
     'enabled': True,
     'materialized': 'snapshot',
     'persist_docs': {},
     'post-hook': [],
     'pre-hook': [],
     'quoting': {},
     'strategy': 'check',
     'tags': [],
     'target_database': 'dellstore',
     'target_schema': 'public',
     'unique_key': 'id',
     'vars': {}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/snapshots.py", line 82, in parse_file
    self.parse_node(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 377, in render_update
    raise CompilationException(msg, node=node) from exc
dbt.exceptions.CompilationException: Compilation Error in snapshot actors_snapshot (snapshots/actors.sql)
  at path []: 'check_cols' is a required property

2021-10-04 15:39:28.973834 (MainThread): Running with dbt=0.19.0
2021-10-04 15:39:29.094233 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-04 15:39:29.098999 (MainThread): Tracking: tracking
2021-10-04 15:39:29.102867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ec8008b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ee22c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ec8112e0>]}
2021-10-04 15:39:29.157798 (MainThread): Partial parsing not enabled
2021-10-04 15:39:29.163269 (MainThread): Parsing macros/adapters.sql
2021-10-04 15:39:29.205610 (MainThread): Parsing macros/catalog.sql
2021-10-04 15:39:29.210443 (MainThread): Parsing macros/relations.sql
2021-10-04 15:39:29.213497 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 15:39:29.217929 (MainThread): Parsing macros/core.sql
2021-10-04 15:39:29.225332 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 15:39:29.309163 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 15:39:29.312907 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 15:39:29.316094 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 15:39:29.332602 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 15:39:29.335761 (MainThread): Parsing macros/etc/query.sql
2021-10-04 15:39:29.337863 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 15:39:29.339782 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 15:39:29.357241 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 15:39:29.397893 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 15:39:29.401607 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 15:39:29.462728 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 15:39:29.495005 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 15:39:29.506395 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 15:39:29.510041 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 15:39:29.537540 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 15:39:29.546740 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 15:39:29.558857 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 15:39:29.572939 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 15:39:29.576776 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 15:39:29.580129 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 15:39:29.584228 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 15:39:29.607053 (MainThread): Partial parsing not enabled
2021-10-04 15:39:29.673921 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 15:39:29.719057 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:39:29.743852 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:39:29.780595 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:39:29.795936 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ec7caa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ec646bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ec654f40>]}
2021-10-04 15:39:29.796765 (MainThread): Flushing usage events
2021-10-04 15:39:30.297165 (MainThread): Connection 'snapshot.my_new_project.actors_snapshot' was properly closed.
2021-10-04 15:39:30.299574 (MainThread): Encountered an error:
2021-10-04 15:39:30.300803 (MainThread): Compilation Error in snapshot actors_snapshot (snapshots/actors.sql)
  at path []: 'check_cols' is a required property
2021-10-04 15:39:30.317315 (MainThread): jsonschema.exceptions.ValidationError: 'check_cols' is a required property

Failed validating 'required' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': True,
     'definitions': {'Hook': {'additionalProperties': False,
                              'description': 'Hook(sql: str, transaction: '
                                             'bool = True, index: '
                                             'Union[int, NoneType] = None)',
                              'properties': {'index': {'oneOf': [{'type': 'integer'},
                                                                 {'type': 'null'}]},
                                             'sql': {'type': 'string'},
                                             'transaction': {'default': True,
                                                             'type': 'boolean'}},
                              'required': ['sql'],
                              'type': 'object'}},
     'description': 'CheckSnapshotConfig(*args, **kwds)',
     'properties': {'alias': {'oneOf': [{'type': 'string'},
                                        {'type': 'null'}]},
                    'check_cols': {'oneOf': [{'enum': ['all'],
                                              'type': 'string'},
                                             {'items': {'type': 'string'},
                                              'type': 'array'}]},
                    'column_types': {'default': {}, 'type': 'object'},
                    'database': {'oneOf': [{'type': 'string'},
                                           {'type': 'null'}]},
                    'enabled': {'default': True, 'type': 'boolean'},
                    'full_refresh': {'oneOf': [{'type': 'boolean'},
                                               {'type': 'null'}]},
                    'materialized': {'default': 'snapshot',
                                     'type': 'string'},
                    'persist_docs': {'default': {}, 'type': 'object'},
                    'post-hook': {'default': [],
                                  'items': {'$ref': '#/definitions/Hook'},
                                  'type': 'array'},
                    'pre-hook': {'default': [],
                                 'items': {'$ref': '#/definitions/Hook'},
                                 'type': 'array'},
                    'quoting': {'default': {}, 'type': 'object'},
                    'schema': {'oneOf': [{'type': 'string'},
                                         {'type': 'null'}]},
                    'strategy': {'enum': ['check'], 'type': 'string'},
                    'tags': {'default': [],
                             'oneOf': [{'items': {'type': 'string'},
                                        'type': 'array'},
                                       {'type': 'string'}]},
                    'target_database': {'oneOf': [{'type': 'string'},
                                                  {'type': 'null'}]},
                    'target_schema': {'type': 'string'},
                    'unique_key': {'type': 'string'},
                    'vars': {'default': {}, 'type': 'object'}},
     'required': ['unique_key', 'target_schema', 'strategy', 'check_cols'],
     'type': 'object'}

On instance:
    {'check_col': ['movie_number', 'movie_prices'],
     'column_types': {},
     'enabled': True,
     'materialized': 'snapshot',
     'persist_docs': {},
     'post-hook': [],
     'pre-hook': [],
     'quoting': {},
     'strategy': 'check',
     'tags': [],
     'target_database': 'dellstore',
     'target_schema': 'public',
     'unique_key': 'id',
     'vars': {}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 373, in render_update
    self.update_parsed_node(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 316, in update_parsed_node
    config_dict = config.build_config_dict()
  File "/usr/local/lib/python3.8/site-packages/dbt/context/context_config.py", line 270, in build_config_dict
    return src.calculate_node_config_dict(
  File "/usr/local/lib/python3.8/site-packages/dbt/context/context_config.py", line 198, in calculate_node_config_dict
    finalized = config.finalize_and_validate()
  File "/usr/local/lib/python3.8/site-packages/dbt/contracts/graph/model_config.py", line 552, in finalize_and_validate
    return SnapshotWrapper.from_dict({'config': data}).config
  File "/usr/local/lib/python3.8/site-packages/hologram/__init__.py", line 624, in from_dict
    cls.validate(data)
  File "/usr/local/lib/python3.8/site-packages/dbt/contracts/graph/model_config.py", line 508, in validate
    raise ValidationError.create_from(error) from error
hologram.ValidationError: 'check_cols' is a required property

Failed validating 'required' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': True,
     'definitions': {'Hook': {'additionalProperties': False,
                              'description': 'Hook(sql: str, transaction: '
                                             'bool = True, index: '
                                             'Union[int, NoneType] = None)',
                              'properties': {'index': {'oneOf': [{'type': 'integer'},
                                                                 {'type': 'null'}]},
                                             'sql': {'type': 'string'},
                                             'transaction': {'default': True,
                                                             'type': 'boolean'}},
                              'required': ['sql'],
                              'type': 'object'}},
     'description': 'CheckSnapshotConfig(*args, **kwds)',
     'properties': {'alias': {'oneOf': [{'type': 'string'},
                                        {'type': 'null'}]},
                    'check_cols': {'oneOf': [{'enum': ['all'],
                                              'type': 'string'},
                                             {'items': {'type': 'string'},
                                              'type': 'array'}]},
                    'column_types': {'default': {}, 'type': 'object'},
                    'database': {'oneOf': [{'type': 'string'},
                                           {'type': 'null'}]},
                    'enabled': {'default': True, 'type': 'boolean'},
                    'full_refresh': {'oneOf': [{'type': 'boolean'},
                                               {'type': 'null'}]},
                    'materialized': {'default': 'snapshot',
                                     'type': 'string'},
                    'persist_docs': {'default': {}, 'type': 'object'},
                    'post-hook': {'default': [],
                                  'items': {'$ref': '#/definitions/Hook'},
                                  'type': 'array'},
                    'pre-hook': {'default': [],
                                 'items': {'$ref': '#/definitions/Hook'},
                                 'type': 'array'},
                    'quoting': {'default': {}, 'type': 'object'},
                    'schema': {'oneOf': [{'type': 'string'},
                                         {'type': 'null'}]},
                    'strategy': {'enum': ['check'], 'type': 'string'},
                    'tags': {'default': [],
                             'oneOf': [{'items': {'type': 'string'},
                                        'type': 'array'},
                                       {'type': 'string'}]},
                    'target_database': {'oneOf': [{'type': 'string'},
                                                  {'type': 'null'}]},
                    'target_schema': {'type': 'string'},
                    'unique_key': {'type': 'string'},
                    'vars': {'default': {}, 'type': 'object'}},
     'required': ['unique_key', 'target_schema', 'strategy', 'check_cols'],
     'type': 'object'}

On instance:
    {'check_col': ['movie_number', 'movie_prices'],
     'column_types': {},
     'enabled': True,
     'materialized': 'snapshot',
     'persist_docs': {},
     'post-hook': [],
     'pre-hook': [],
     'quoting': {},
     'strategy': 'check',
     'tags': [],
     'target_database': 'dellstore',
     'target_schema': 'public',
     'unique_key': 'id',
     'vars': {}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/snapshots.py", line 82, in parse_file
    self.parse_node(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 377, in render_update
    raise CompilationException(msg, node=node) from exc
dbt.exceptions.CompilationException: Compilation Error in snapshot actors_snapshot (snapshots/actors.sql)
  at path []: 'check_cols' is a required property

2021-10-04 15:39:39.800838 (MainThread): Running with dbt=0.19.0
2021-10-04 15:39:39.928198 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-04 15:39:39.933639 (MainThread): Tracking: tracking
2021-10-04 15:39:39.937052 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c58a0d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5c013400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c58a1d220>]}
2021-10-04 15:39:39.982329 (MainThread): Partial parsing not enabled
2021-10-04 15:39:39.986505 (MainThread): Parsing macros/adapters.sql
2021-10-04 15:39:40.027106 (MainThread): Parsing macros/catalog.sql
2021-10-04 15:39:40.031824 (MainThread): Parsing macros/relations.sql
2021-10-04 15:39:40.034802 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 15:39:40.039393 (MainThread): Parsing macros/core.sql
2021-10-04 15:39:40.046638 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 15:39:40.133889 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 15:39:40.138488 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 15:39:40.144244 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 15:39:40.167867 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 15:39:40.171848 (MainThread): Parsing macros/etc/query.sql
2021-10-04 15:39:40.174275 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 15:39:40.176852 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 15:39:40.197650 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 15:39:40.237002 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 15:39:40.240593 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 15:39:40.303660 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 15:39:40.335800 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 15:39:40.347114 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 15:39:40.350609 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 15:39:40.378105 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 15:39:40.387269 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 15:39:40.399782 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 15:39:40.412602 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 15:39:40.415974 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 15:39:40.418754 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 15:39:40.422202 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 15:39:40.441404 (MainThread): Partial parsing not enabled
2021-10-04 15:39:40.508257 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 15:39:40.547437 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:39:40.572244 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:39:40.613782 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:39:40.867281 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5877a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5876ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c58784400>]}
2021-10-04 15:39:40.868044 (MainThread): Flushing usage events
2021-10-04 15:39:41.363495 (MainThread): Connection 'snapshot.my_new_project.actors_snapshot' was properly closed.
2021-10-04 15:39:41.364649 (MainThread): Encountered an error:
2021-10-04 15:39:41.365209 (MainThread): Compilation Error in snapshot actors_snapshot (snapshots/actors.sql)
  Snapshot 'snapshot.my_new_project.actors_snapshot' (snapshots/actors.sql) depends on a source named 'dellstore_database.actors' which was not found
2021-10-04 15:39:41.367548 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 379, in process_manifest
    process_sources(manifest, project_name)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 812, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 795, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 498, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in snapshot actors_snapshot (snapshots/actors.sql)
  Snapshot 'snapshot.my_new_project.actors_snapshot' (snapshots/actors.sql) depends on a source named 'dellstore_database.actors' which was not found

2021-10-04 15:41:02.903957 (MainThread): Running with dbt=0.19.0
2021-10-04 15:41:03.031061 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-04 15:41:03.035153 (MainThread): Tracking: tracking
2021-10-04 15:41:03.038560 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef7c9ff7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef800053d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef7ca101f0>]}
2021-10-04 15:41:03.087221 (MainThread): Partial parsing not enabled
2021-10-04 15:41:03.091273 (MainThread): Parsing macros/adapters.sql
2021-10-04 15:41:03.133377 (MainThread): Parsing macros/catalog.sql
2021-10-04 15:41:03.139973 (MainThread): Parsing macros/relations.sql
2021-10-04 15:41:03.145695 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 15:41:03.151726 (MainThread): Parsing macros/core.sql
2021-10-04 15:41:03.161927 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 15:41:03.249982 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 15:41:03.253870 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 15:41:03.257623 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 15:41:03.274889 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 15:41:03.278510 (MainThread): Parsing macros/etc/query.sql
2021-10-04 15:41:03.281064 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 15:41:03.283215 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 15:41:03.300594 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 15:41:03.340665 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 15:41:03.344527 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 15:41:03.406675 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 15:41:03.438820 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 15:41:03.450284 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 15:41:03.453985 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 15:41:03.481699 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 15:41:03.491138 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 15:41:03.503252 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 15:41:03.515854 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 15:41:03.519145 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 15:41:03.521941 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 15:41:03.525366 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 15:41:03.545092 (MainThread): Partial parsing not enabled
2021-10-04 15:41:03.618650 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 15:41:03.658640 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:41:03.682375 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:41:03.718579 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:41:03.970194 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef7c76f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef7c762f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef7c7783d0>]}
2021-10-04 15:41:03.970993 (MainThread): Flushing usage events
2021-10-04 15:41:04.576904 (MainThread): Connection 'snapshot.my_new_project.actors_snapshot' was properly closed.
2021-10-04 15:41:04.578130 (MainThread): Encountered an error:
2021-10-04 15:41:04.578832 (MainThread): Compilation Error in snapshot actors_snapshot (snapshots/actors.sql)
  Snapshot 'snapshot.my_new_project.actors_snapshot' (snapshots/actors.sql) depends on a source named 'dellstore_database.actors' which was not found
2021-10-04 15:41:04.581566 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 379, in process_manifest
    process_sources(manifest, project_name)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 812, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 795, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 498, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in snapshot actors_snapshot (snapshots/actors.sql)
  Snapshot 'snapshot.my_new_project.actors_snapshot' (snapshots/actors.sql) depends on a source named 'dellstore_database.actors' which was not found

2021-10-04 15:41:13.333334 (MainThread): Running with dbt=0.19.0
2021-10-04 15:41:13.460004 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-04 15:41:13.465720 (MainThread): Tracking: tracking
2021-10-04 15:41:13.469449 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e35d13820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e39319430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e35d23250>]}
2021-10-04 15:41:13.517555 (MainThread): Partial parsing not enabled
2021-10-04 15:41:13.522507 (MainThread): Parsing macros/adapters.sql
2021-10-04 15:41:13.566679 (MainThread): Parsing macros/catalog.sql
2021-10-04 15:41:13.572407 (MainThread): Parsing macros/relations.sql
2021-10-04 15:41:13.576013 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 15:41:13.581755 (MainThread): Parsing macros/core.sql
2021-10-04 15:41:13.592989 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 15:41:13.682980 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 15:41:13.687230 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 15:41:13.690733 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 15:41:13.708129 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 15:41:13.711545 (MainThread): Parsing macros/etc/query.sql
2021-10-04 15:41:13.713866 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 15:41:13.716038 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 15:41:13.733211 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 15:41:13.777073 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 15:41:13.780704 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 15:41:13.844785 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 15:41:13.877423 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 15:41:13.888865 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 15:41:13.892748 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 15:41:13.920345 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 15:41:13.930035 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 15:41:13.942152 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 15:41:13.955007 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 15:41:13.958342 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 15:41:13.961133 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 15:41:13.964558 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 15:41:13.983464 (MainThread): Partial parsing not enabled
2021-10-04 15:41:14.050989 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 15:41:14.091008 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:41:14.119444 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:41:14.168897 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:41:14.455905 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d795118-b1f4-42c9-a483-ec8462aed4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e35a9a640>]}
2021-10-04 15:41:14.526944 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-04 15:41:14.529139 (MainThread): Found 3 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-04 15:41:14.530853 (MainThread): 
2021-10-04 15:41:14.532298 (MainThread): Acquiring new postgres connection "master".
2021-10-04 15:41:14.536671 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-04 15:41:14.554995 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-04 15:41:14.555723 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-04 15:41:14.556317 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-04 15:41:14.563253 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-04 15:41:14.567080 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-04 15:41:14.577450 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-04 15:41:14.586804 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 15:41:14.587671 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-04 15:41:14.588338 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-04 15:41:14.592611 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:41:14.593138 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 15:41:14.593632 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-04 15:41:14.597134 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-04 15:41:14.613067 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-04 15:41:14.614014 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-04 15:41:14.628474 (MainThread): Using postgres connection "master".
2021-10-04 15:41:14.629110 (MainThread): On master: BEGIN
2021-10-04 15:41:14.629591 (MainThread): Opening a new connection, currently in state init
2021-10-04 15:41:14.633715 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:41:14.634497 (MainThread): Using postgres connection "master".
2021-10-04 15:41:14.635146 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-04 15:41:14.641741 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2021-10-04 15:41:14.645500 (MainThread): On master: ROLLBACK
2021-10-04 15:41:14.646381 (MainThread): Using postgres connection "master".
2021-10-04 15:41:14.646888 (MainThread): On master: BEGIN
2021-10-04 15:41:14.647872 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:41:14.648256 (MainThread): On master: COMMIT
2021-10-04 15:41:14.648717 (MainThread): Using postgres connection "master".
2021-10-04 15:41:14.649163 (MainThread): On master: COMMIT
2021-10-04 15:41:14.649959 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 15:41:14.650492 (MainThread): On master: Close
2021-10-04 15:41:14.651316 (MainThread): 15:41:14 | Concurrency: 2 threads (target='dev')
2021-10-04 15:41:14.651826 (MainThread): 15:41:14 | 
2021-10-04 15:41:14.657253 (Thread-1): Began running node snapshot.my_new_project.actors_snapshot
2021-10-04 15:41:14.660121 (Thread-1): 15:41:14 | 1 of 1 START snapshot public.actors_snapshot......................... [RUN]
2021-10-04 15:41:14.687181 (Thread-1): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:41:14.687848 (Thread-1): Compiling snapshot.my_new_project.actors_snapshot
2021-10-04 15:41:14.718062 (Thread-1): finished collecting timing info
2021-10-04 15:41:14.768886 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:41:14.769648 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

    select count(*) from pg_namespace where nspname = 'public'
  
2021-10-04 15:41:14.770175 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 15:41:14.775074 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-04 15:41:14.825814 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:41:14.826399 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

    select now()::timestamp without time zone as snapshot_start
  
2021-10-04 15:41:14.828161 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-04 15:41:14.845352 (Thread-1): Writing runtime SQL for node "snapshot.my_new_project.actors_snapshot"
2021-10-04 15:41:14.858790 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:41:14.859187 (Thread-1): On snapshot.my_new_project.actors_snapshot: BEGIN
2021-10-04 15:41:14.859957 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:41:14.860485 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:41:14.861139 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

      

  create  table "dellstore"."public"."actors_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast('2021-10-04 15:41:14.774039'::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        '2021-10-04 15:41:14.774039'::timestamp without time zone as dbt_updated_at,
        '2021-10-04 15:41:14.774039'::timestamp without time zone as dbt_valid_from,
        nullif('2021-10-04 15:41:14.774039'::timestamp without time zone, '2021-10-04 15:41:14.774039'::timestamp without time zone) as dbt_valid_to
    from (
        



SELECT * FROM "dellstore"."public"."actors"

    ) sbq


  );
  
2021-10-04 15:41:14.862823 (Thread-1): Postgres error: column "id" does not exist
LINE 10:         md5(coalesce(cast(id as varchar ), '')
                                   ^

2021-10-04 15:41:14.863345 (Thread-1): On snapshot.my_new_project.actors_snapshot: ROLLBACK
2021-10-04 15:41:14.864626 (Thread-1): finished collecting timing info
2021-10-04 15:41:14.865986 (Thread-1): On snapshot.my_new_project.actors_snapshot: Close
2021-10-04 15:41:14.868539 (Thread-1): Database Error in snapshot actors_snapshot (snapshots/actors.sql)
  column "id" does not exist
  LINE 10:         md5(coalesce(cast(id as varchar ), '')
                                     ^
  compiled SQL at target/run/my_new_project/snapshots/actors.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "id" does not exist
LINE 10:         md5(coalesce(cast(id as varchar ), '')
                                   ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 155, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in snapshot actors_snapshot (snapshots/actors.sql)
  column "id" does not exist
  LINE 10:         md5(coalesce(cast(id as varchar ), '')
                                     ^
  compiled SQL at target/run/my_new_project/snapshots/actors.sql
2021-10-04 15:41:14.878902 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d795118-b1f4-42c9-a483-ec8462aed4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e351df6a0>]}
2021-10-04 15:41:14.881118 (Thread-1): 15:41:14 | 1 of 1 ERROR snapshotting public.actors_snapshot..................... [ERROR in 0.19s]
2021-10-04 15:41:14.881597 (Thread-1): Finished running node snapshot.my_new_project.actors_snapshot
2021-10-04 15:41:14.884688 (MainThread): Acquiring new postgres connection "master".
2021-10-04 15:41:14.885410 (MainThread): Using postgres connection "master".
2021-10-04 15:41:14.885869 (MainThread): On master: BEGIN
2021-10-04 15:41:14.886325 (MainThread): Opening a new connection, currently in state closed
2021-10-04 15:41:14.890597 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:41:14.891217 (MainThread): On master: COMMIT
2021-10-04 15:41:14.891789 (MainThread): Using postgres connection "master".
2021-10-04 15:41:14.892294 (MainThread): On master: COMMIT
2021-10-04 15:41:14.893060 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 15:41:14.893593 (MainThread): On master: Close
2021-10-04 15:41:14.894513 (MainThread): 15:41:14 | 
2021-10-04 15:41:14.895036 (MainThread): 15:41:14 | Finished running 1 snapshot in 0.36s.
2021-10-04 15:41:14.895516 (MainThread): Connection 'master' was properly closed.
2021-10-04 15:41:14.896009 (MainThread): Connection 'snapshot.my_new_project.actors_snapshot' was properly closed.
2021-10-04 15:41:14.965940 (MainThread): 
2021-10-04 15:41:14.966600 (MainThread): Completed with 1 error and 0 warnings:
2021-10-04 15:41:14.967423 (MainThread): 
2021-10-04 15:41:14.968474 (MainThread): Database Error in snapshot actors_snapshot (snapshots/actors.sql)
2021-10-04 15:41:14.969900 (MainThread):   column "id" does not exist
2021-10-04 15:41:14.970777 (MainThread):   LINE 10:         md5(coalesce(cast(id as varchar ), '')
2021-10-04 15:41:14.971622 (MainThread):                                      ^
2021-10-04 15:41:14.972554 (MainThread):   compiled SQL at target/run/my_new_project/snapshots/actors.sql
2021-10-04 15:41:14.973513 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-04 15:41:14.974790 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e35a51b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e35a677f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e35a677c0>]}
2021-10-04 15:41:14.975838 (MainThread): Flushing usage events
2021-10-04 15:44:40.121442 (MainThread): Running with dbt=0.19.0
2021-10-04 15:44:40.260655 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-04 15:44:40.266450 (MainThread): Tracking: tracking
2021-10-04 15:44:40.269968 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc663f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc9c453d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc66501f0>]}
2021-10-04 15:44:40.314022 (MainThread): Partial parsing not enabled
2021-10-04 15:44:40.318351 (MainThread): Parsing macros/adapters.sql
2021-10-04 15:44:40.358903 (MainThread): Parsing macros/catalog.sql
2021-10-04 15:44:40.363694 (MainThread): Parsing macros/relations.sql
2021-10-04 15:44:40.366981 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 15:44:40.371505 (MainThread): Parsing macros/core.sql
2021-10-04 15:44:40.378907 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 15:44:40.464764 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 15:44:40.468572 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 15:44:40.471646 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 15:44:40.488380 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 15:44:40.492268 (MainThread): Parsing macros/etc/query.sql
2021-10-04 15:44:40.494583 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 15:44:40.496425 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 15:44:40.513201 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 15:44:40.553303 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 15:44:40.556968 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 15:44:40.620363 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 15:44:40.652548 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 15:44:40.663860 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 15:44:40.667570 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 15:44:40.694586 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 15:44:40.703780 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 15:44:40.716045 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 15:44:40.728174 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 15:44:40.731512 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 15:44:40.734722 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 15:44:40.738510 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 15:44:40.757874 (MainThread): Partial parsing not enabled
2021-10-04 15:44:40.824135 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 15:44:40.865042 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 15:44:40.890262 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 15:44:40.932402 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:44:41.242697 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '374b8cfa-e162-43b4-a35a-ba5ef342533c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc6491a00>]}
2021-10-04 15:44:41.309817 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-04 15:44:41.311713 (MainThread): Found 3 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-04 15:44:41.313354 (MainThread): 
2021-10-04 15:44:41.315086 (MainThread): Acquiring new postgres connection "master".
2021-10-04 15:44:41.319421 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-04 15:44:41.337004 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-04 15:44:41.337607 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-04 15:44:41.338136 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-04 15:44:41.342813 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2021-10-04 15:44:41.346638 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-04 15:44:41.357234 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-04 15:44:41.366273 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 15:44:41.366926 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-04 15:44:41.367602 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-04 15:44:41.371858 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:44:41.372497 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 15:44:41.373030 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-04 15:44:41.376196 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-04 15:44:41.391003 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-04 15:44:41.391985 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-04 15:44:41.405362 (MainThread): Using postgres connection "master".
2021-10-04 15:44:41.406000 (MainThread): On master: BEGIN
2021-10-04 15:44:41.406473 (MainThread): Opening a new connection, currently in state init
2021-10-04 15:44:41.410390 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:44:41.410945 (MainThread): Using postgres connection "master".
2021-10-04 15:44:41.411438 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-04 15:44:41.418065 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2021-10-04 15:44:41.420837 (MainThread): On master: ROLLBACK
2021-10-04 15:44:41.421510 (MainThread): Using postgres connection "master".
2021-10-04 15:44:41.421897 (MainThread): On master: BEGIN
2021-10-04 15:44:41.422753 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:44:41.423203 (MainThread): On master: COMMIT
2021-10-04 15:44:41.423838 (MainThread): Using postgres connection "master".
2021-10-04 15:44:41.424367 (MainThread): On master: COMMIT
2021-10-04 15:44:41.425469 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 15:44:41.426074 (MainThread): On master: Close
2021-10-04 15:44:41.427074 (MainThread): 15:44:41 | Concurrency: 2 threads (target='dev')
2021-10-04 15:44:41.427765 (MainThread): 15:44:41 | 
2021-10-04 15:44:41.432891 (Thread-1): Began running node snapshot.my_new_project.actors_snapshot
2021-10-04 15:44:41.435286 (Thread-1): 15:44:41 | 1 of 1 START snapshot public.actors_snapshot......................... [RUN]
2021-10-04 15:44:41.436503 (Thread-1): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:44:41.437159 (Thread-1): Compiling snapshot.my_new_project.actors_snapshot
2021-10-04 15:44:41.461118 (Thread-1): finished collecting timing info
2021-10-04 15:44:41.513414 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:44:41.514182 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

    select count(*) from pg_namespace where nspname = 'public'
  
2021-10-04 15:44:41.514780 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 15:44:41.519475 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-04 15:44:41.575190 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:44:41.575833 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

    select now()::timestamp without time zone as snapshot_start
  
2021-10-04 15:44:41.576852 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-04 15:44:41.599290 (Thread-1): Writing runtime SQL for node "snapshot.my_new_project.actors_snapshot"
2021-10-04 15:44:41.608661 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:44:41.609139 (Thread-1): On snapshot.my_new_project.actors_snapshot: BEGIN
2021-10-04 15:44:41.609914 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:44:41.610398 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:44:41.610938 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

      

  create  table "dellstore"."public"."actors_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(first_name as varchar ), '')
         || '|' || coalesce(cast('2021-10-04 15:44:41.518514'::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        '2021-10-04 15:44:41.518514'::timestamp without time zone as dbt_updated_at,
        '2021-10-04 15:44:41.518514'::timestamp without time zone as dbt_valid_from,
        nullif('2021-10-04 15:44:41.518514'::timestamp without time zone, '2021-10-04 15:44:41.518514'::timestamp without time zone) as dbt_valid_to
    from (
        



SELECT * FROM "dellstore"."public"."actors"

    ) sbq


  );
  
2021-10-04 15:44:41.638971 (Thread-1): SQL status: SELECT 8802 in 0.03 seconds
2021-10-04 15:44:41.648913 (Thread-1): On snapshot.my_new_project.actors_snapshot: COMMIT
2021-10-04 15:44:41.649570 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 15:44:41.650028 (Thread-1): On snapshot.my_new_project.actors_snapshot: COMMIT
2021-10-04 15:44:41.662831 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-04 15:44:41.665967 (Thread-1): finished collecting timing info
2021-10-04 15:44:41.666601 (Thread-1): On snapshot.my_new_project.actors_snapshot: Close
2021-10-04 15:44:41.667704 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '374b8cfa-e162-43b4-a35a-ba5ef342533c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc5ae7730>]}
2021-10-04 15:44:41.669703 (Thread-1): 15:44:41 | 1 of 1 OK snapshotted public.actors_snapshot......................... [SELECT 8802 in 0.23s]
2021-10-04 15:44:41.670193 (Thread-1): Finished running node snapshot.my_new_project.actors_snapshot
2021-10-04 15:44:41.672694 (MainThread): Acquiring new postgres connection "master".
2021-10-04 15:44:41.673528 (MainThread): Using postgres connection "master".
2021-10-04 15:44:41.674139 (MainThread): On master: BEGIN
2021-10-04 15:44:41.674640 (MainThread): Opening a new connection, currently in state closed
2021-10-04 15:44:41.678846 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 15:44:41.679442 (MainThread): On master: COMMIT
2021-10-04 15:44:41.679962 (MainThread): Using postgres connection "master".
2021-10-04 15:44:41.680355 (MainThread): On master: COMMIT
2021-10-04 15:44:41.681346 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 15:44:41.682040 (MainThread): On master: Close
2021-10-04 15:44:41.683150 (MainThread): 15:44:41 | 
2021-10-04 15:44:41.683838 (MainThread): 15:44:41 | Finished running 1 snapshot in 0.37s.
2021-10-04 15:44:41.684393 (MainThread): Connection 'master' was properly closed.
2021-10-04 15:44:41.685002 (MainThread): Connection 'snapshot.my_new_project.actors_snapshot' was properly closed.
2021-10-04 15:44:41.749405 (MainThread): 
2021-10-04 15:44:41.749907 (MainThread): Completed successfully
2021-10-04 15:44:41.750487 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-04 15:44:41.751406 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc6398e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc5b0bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc5b0b1f0>]}
2021-10-04 15:44:41.752611 (MainThread): Flushing usage events
2021-10-04 16:03:34.784846 (MainThread): Running with dbt=0.19.0
2021-10-04 16:03:34.916683 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-04 16:03:34.923443 (MainThread): Tracking: tracking
2021-10-04 16:03:34.927059 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3e634a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3e9951460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3e635b280>]}
2021-10-04 16:03:34.971680 (MainThread): Partial parsing not enabled
2021-10-04 16:03:34.975423 (MainThread): Parsing macros/adapters.sql
2021-10-04 16:03:35.014276 (MainThread): Parsing macros/catalog.sql
2021-10-04 16:03:35.019086 (MainThread): Parsing macros/relations.sql
2021-10-04 16:03:35.022272 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 16:03:35.027024 (MainThread): Parsing macros/core.sql
2021-10-04 16:03:35.034208 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 16:03:35.123023 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 16:03:35.127446 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 16:03:35.131047 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 16:03:35.153532 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 16:03:35.157175 (MainThread): Parsing macros/etc/query.sql
2021-10-04 16:03:35.159759 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 16:03:35.162963 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 16:03:35.185573 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 16:03:35.232017 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 16:03:35.236353 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 16:03:35.317886 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 16:03:35.366756 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 16:03:35.378433 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 16:03:35.382175 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 16:03:35.409883 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 16:03:35.419152 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 16:03:35.431050 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 16:03:35.443396 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 16:03:35.446753 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 16:03:35.449592 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 16:03:35.453067 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 16:03:35.473317 (MainThread): Partial parsing not enabled
2021-10-04 16:03:35.542665 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 16:03:35.585193 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:03:35.612358 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:03:35.648282 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:35.933738 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cbc6ff7-d7be-47c7-b741-51bf5e3d057a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3e619eb50>]}
2021-10-04 16:03:36.002406 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-04 16:03:36.004432 (MainThread): Found 3 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-04 16:03:36.006100 (MainThread): 
2021-10-04 16:03:36.007362 (MainThread): Acquiring new postgres connection "master".
2021-10-04 16:03:36.011075 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-04 16:03:36.029346 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-04 16:03:36.029989 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-04 16:03:36.030496 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-04 16:03:36.041418 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-04 16:03:36.048318 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-04 16:03:36.060834 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-04 16:03:36.073446 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 16:03:36.074016 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-04 16:03:36.074442 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-04 16:03:36.079946 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-04 16:03:36.080746 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 16:03:36.081617 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-04 16:03:36.087616 (ThreadPoolExecutor-1_0): SQL status: SELECT 12 in 0.00 seconds
2021-10-04 16:03:36.110452 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-04 16:03:36.111474 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-04 16:03:36.135256 (MainThread): Using postgres connection "master".
2021-10-04 16:03:36.136009 (MainThread): On master: BEGIN
2021-10-04 16:03:36.136543 (MainThread): Opening a new connection, currently in state init
2021-10-04 16:03:36.142213 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-04 16:03:36.142988 (MainThread): Using postgres connection "master".
2021-10-04 16:03:36.143670 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-04 16:03:36.154043 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2021-10-04 16:03:36.159536 (MainThread): On master: ROLLBACK
2021-10-04 16:03:36.160596 (MainThread): Using postgres connection "master".
2021-10-04 16:03:36.161302 (MainThread): On master: BEGIN
2021-10-04 16:03:36.162565 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:03:36.163337 (MainThread): On master: COMMIT
2021-10-04 16:03:36.164118 (MainThread): Using postgres connection "master".
2021-10-04 16:03:36.165257 (MainThread): On master: COMMIT
2021-10-04 16:03:36.166668 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:03:36.167508 (MainThread): On master: Close
2021-10-04 16:03:36.169062 (MainThread): 16:03:36 | Concurrency: 2 threads (target='dev')
2021-10-04 16:03:36.169843 (MainThread): 16:03:36 | 
2021-10-04 16:03:36.177471 (Thread-1): Began running node snapshot.my_new_project.actors_snapshot
2021-10-04 16:03:36.181294 (Thread-1): 16:03:36 | 1 of 1 START snapshot public.actors_snapshot......................... [RUN]
2021-10-04 16:03:36.182842 (Thread-1): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:36.183827 (Thread-1): Compiling snapshot.my_new_project.actors_snapshot
2021-10-04 16:03:36.228279 (Thread-1): finished collecting timing info
2021-10-04 16:03:36.311343 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:36.311880 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

    select count(*) from pg_namespace where nspname = 'public'
  
2021-10-04 16:03:36.312212 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 16:03:36.317802 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-10-04 16:03:36.369924 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:36.370587 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

    select now()::timestamp without time zone as snapshot_start
  
2021-10-04 16:03:36.371582 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-04 16:03:36.390538 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:36.391152 (Thread-1): On snapshot.my_new_project.actors_snapshot: BEGIN
2021-10-04 16:03:36.391975 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:03:36.392330 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:36.392771 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'actors_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-04 16:03:36.406578 (Thread-1): SQL status: SELECT 7 in 0.01 seconds
2021-10-04 16:03:36.443947 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:36.444576 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

        

  create temporary table "actors_snapshot__dbt_tmp160336427247"
  as (
    with snapshot_query as (

        



SELECT * FROM "dellstore"."public"."actors"


    ),

    snapshotted_data as (

        select *,
            first_name as dbt_unique_key

        from "dellstore"."public"."actors_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            first_name as dbt_unique_key,
            '2021-10-04 16:03:36.316589'::timestamp without time zone as dbt_updated_at,
            '2021-10-04 16:03:36.316589'::timestamp without time zone as dbt_valid_from,
            nullif('2021-10-04 16:03:36.316589'::timestamp without time zone, '2021-10-04 16:03:36.316589'::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(first_name as varchar ), '')
         || '|' || coalesce(cast('2021-10-04 16:03:36.316589'::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            first_name as dbt_unique_key,
            '2021-10-04 16:03:36.316589'::timestamp without time zone as dbt_updated_at,
            '2021-10-04 16:03:36.316589'::timestamp without time zone as dbt_valid_from,
            '2021-10-04 16:03:36.316589'::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.movie_number != source_data.movie_number
        or
        (
            ((snapshotted_data.movie_number is null) and not (source_data.movie_number is null))
            or
            ((not snapshotted_data.movie_number is null) and (source_data.movie_number is null))
        ) or snapshotted_data.movie_prices != source_data.movie_prices
        or
        (
            ((snapshotted_data.movie_prices is null) and not (source_data.movie_prices is null))
            or
            ((not snapshotted_data.movie_prices is null) and (source_data.movie_prices is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.movie_number != source_data.movie_number
        or
        (
            ((snapshotted_data.movie_number is null) and not (source_data.movie_number is null))
            or
            ((not snapshotted_data.movie_number is null) and (source_data.movie_number is null))
        ) or snapshotted_data.movie_prices != source_data.movie_prices
        or
        (
            ((snapshotted_data.movie_prices is null) and not (source_data.movie_prices is null))
            or
            ((not snapshotted_data.movie_prices is null) and (source_data.movie_prices is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates
  );
    
2021-10-04 16:03:37.755784 (Thread-1): SQL status: SELECT 741212 in 1.31 seconds
2021-10-04 16:03:37.761424 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:37.762023 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'actors_snapshot__dbt_tmp160336427247'
        
      order by ordinal_position

  
2021-10-04 16:03:37.765730 (Thread-1): SQL status: SELECT 9 in 0.00 seconds
2021-10-04 16:03:37.771327 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:37.771916 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'actors_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-04 16:03:37.775864 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-10-04 16:03:37.781525 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:37.782146 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'actors_snapshot__dbt_tmp160336427247'
        
      order by ordinal_position

  
2021-10-04 16:03:37.786136 (Thread-1): SQL status: SELECT 9 in 0.00 seconds
2021-10-04 16:03:37.791833 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:37.792443 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'actors_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-04 16:03:37.796167 (Thread-1): SQL status: SELECT 7 in 0.00 seconds
2021-10-04 16:03:37.807328 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:37.808032 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'actors_snapshot__dbt_tmp160336427247'
        
      order by ordinal_position

  
2021-10-04 16:03:37.811845 (Thread-1): SQL status: SELECT 9 in 0.00 seconds
2021-10-04 16:03:37.820354 (Thread-1): Writing runtime SQL for node "snapshot.my_new_project.actors_snapshot"
2021-10-04 16:03:37.831013 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:37.831427 (Thread-1): On snapshot.my_new_project.actors_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.actors_snapshot"} */

      update "dellstore"."public"."actors_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "actors_snapshot__dbt_tmp160336427247" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dellstore"."public"."actors_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "dellstore"."public"."actors_snapshot".dbt_valid_to is null;

    insert into "dellstore"."public"."actors_snapshot" ("first_name", "movie_number", "movie_prices", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."first_name",DBT_INTERNAL_SOURCE."movie_number",DBT_INTERNAL_SOURCE."movie_prices",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "actors_snapshot__dbt_tmp160336427247" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
2021-10-04 16:03:49.920908 (Thread-1): SQL status: INSERT 0 370606 in 12.09 seconds
2021-10-04 16:03:49.939173 (Thread-1): On snapshot.my_new_project.actors_snapshot: COMMIT
2021-10-04 16:03:49.939779 (Thread-1): Using postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:03:49.940198 (Thread-1): On snapshot.my_new_project.actors_snapshot: COMMIT
2021-10-04 16:03:49.995869 (Thread-1): SQL status: COMMIT in 0.06 seconds
2021-10-04 16:03:50.002743 (Thread-1): finished collecting timing info
2021-10-04 16:03:50.003510 (Thread-1): On snapshot.my_new_project.actors_snapshot: Close
2021-10-04 16:03:50.004837 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cbc6ff7-d7be-47c7-b741-51bf5e3d057a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3e58008b0>]}
2021-10-04 16:03:50.007539 (Thread-1): 16:03:49 | 1 of 1 OK snapshotted public.actors_snapshot......................... [INSERT 0 370606 in 13.82s]
2021-10-04 16:03:50.008275 (Thread-1): Finished running node snapshot.my_new_project.actors_snapshot
2021-10-04 16:03:50.011440 (MainThread): Acquiring new postgres connection "master".
2021-10-04 16:03:50.012311 (MainThread): Using postgres connection "master".
2021-10-04 16:03:50.012797 (MainThread): On master: BEGIN
2021-10-04 16:03:50.013394 (MainThread): Opening a new connection, currently in state closed
2021-10-04 16:03:50.019877 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-04 16:03:50.020734 (MainThread): On master: COMMIT
2021-10-04 16:03:50.021642 (MainThread): Using postgres connection "master".
2021-10-04 16:03:50.022634 (MainThread): On master: COMMIT
2021-10-04 16:03:50.024192 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:03:50.024982 (MainThread): On master: Close
2021-10-04 16:03:50.026214 (MainThread): 16:03:50 | 
2021-10-04 16:03:50.026842 (MainThread): 16:03:50 | Finished running 1 snapshot in 14.02s.
2021-10-04 16:03:50.027394 (MainThread): Connection 'master' was properly closed.
2021-10-04 16:03:50.027955 (MainThread): Connection 'snapshot.my_new_project.actors_snapshot' was properly closed.
2021-10-04 16:03:50.095927 (MainThread): 
2021-10-04 16:03:50.096453 (MainThread): Completed successfully
2021-10-04 16:03:50.097130 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-04 16:03:50.098389 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3e607a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3e608fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3e608fd00>]}
2021-10-04 16:03:50.099562 (MainThread): Flushing usage events
2021-10-04 16:15:47.662417 (MainThread): Running with dbt=0.19.0
2021-10-04 16:15:47.845252 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 16:15:47.851423 (MainThread): Tracking: tracking
2021-10-04 16:15:47.855780 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd239aa2940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23d0a9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd239ab3130>]}
2021-10-04 16:15:47.905633 (MainThread): Partial parsing not enabled
2021-10-04 16:15:47.910841 (MainThread): Parsing macros/adapters.sql
2021-10-04 16:15:47.948958 (MainThread): Parsing macros/catalog.sql
2021-10-04 16:15:47.953992 (MainThread): Parsing macros/relations.sql
2021-10-04 16:15:47.957159 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 16:15:47.962623 (MainThread): Parsing macros/core.sql
2021-10-04 16:15:47.969872 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 16:15:48.056518 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 16:15:48.060681 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 16:15:48.064072 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 16:15:48.081429 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 16:15:48.084766 (MainThread): Parsing macros/etc/query.sql
2021-10-04 16:15:48.087012 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 16:15:48.089110 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 16:15:48.109396 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 16:15:48.153324 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 16:15:48.157069 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 16:15:48.230449 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 16:15:48.273041 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 16:15:48.285651 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 16:15:48.289212 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 16:15:48.317789 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 16:15:48.327943 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 16:15:48.342532 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 16:15:48.356479 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 16:15:48.361389 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 16:15:48.365906 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 16:15:48.370688 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 16:15:48.392225 (MainThread): Partial parsing not enabled
2021-10-04 16:15:48.523807 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 16:15:48.578938 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:15:48.607759 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:15:48.655539 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:15:49.005212 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f47eb0c-001a-4d8a-aa61-d67e1b73fb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23983bb80>]}
2021-10-04 16:15:49.090570 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-04 16:15:49.095416 (MainThread): Found 3 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-04 16:15:49.098956 (MainThread): 
2021-10-04 16:15:49.100482 (MainThread): Acquiring new postgres connection "master".
2021-10-04 16:15:49.116527 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-04 16:15:49.141703 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-04 16:15:49.142290 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-04 16:15:49.142825 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-04 16:15:49.161803 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-04 16:15:49.165778 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-04 16:15:49.174945 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-04 16:15:49.183738 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 16:15:49.184381 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-04 16:15:49.184820 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-04 16:15:49.191720 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-04 16:15:49.192452 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 16:15:49.192841 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-04 16:15:49.197975 (ThreadPoolExecutor-1_0): SQL status: SELECT 12 in 0.00 seconds
2021-10-04 16:15:49.211920 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-04 16:15:49.212912 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-04 16:15:49.226689 (MainThread): Using postgres connection "master".
2021-10-04 16:15:49.227346 (MainThread): On master: BEGIN
2021-10-04 16:15:49.227873 (MainThread): Opening a new connection, currently in state init
2021-10-04 16:15:49.236054 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-04 16:15:49.236731 (MainThread): Using postgres connection "master".
2021-10-04 16:15:49.237209 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-04 16:15:49.250987 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2021-10-04 16:15:49.253710 (MainThread): On master: ROLLBACK
2021-10-04 16:15:49.254522 (MainThread): Using postgres connection "master".
2021-10-04 16:15:49.254967 (MainThread): On master: BEGIN
2021-10-04 16:15:49.255914 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:15:49.256772 (MainThread): On master: COMMIT
2021-10-04 16:15:49.257469 (MainThread): Using postgres connection "master".
2021-10-04 16:15:49.258173 (MainThread): On master: COMMIT
2021-10-04 16:15:49.259483 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:15:49.260225 (MainThread): On master: Close
2021-10-04 16:15:49.261115 (MainThread): 16:15:49 | Concurrency: 2 threads (target='dev')
2021-10-04 16:15:49.261775 (MainThread): 16:15:49 | 
2021-10-04 16:15:49.270430 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-10-04 16:15:49.270823 (Thread-2): Began running node model.my_new_project.actors
2021-10-04 16:15:49.273534 (Thread-1): 16:15:49 | 1 of 3 START table model public.my_first_dbt_model................... [RUN]
2021-10-04 16:15:49.276826 (Thread-2): 16:15:49 | 2 of 3 START table model public.actors............................... [RUN]
2021-10-04 16:15:49.278210 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:15:49.279132 (Thread-2): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 16:15:49.279579 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-10-04 16:15:49.280530 (Thread-2): Compiling model.my_new_project.actors
2021-10-04 16:15:49.318270 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-04 16:15:49.320483 (Thread-2): Writing injected SQL for node "model.my_new_project.actors"
2021-10-04 16:15:49.330882 (Thread-2): finished collecting timing info
2021-10-04 16:15:49.344442 (Thread-1): finished collecting timing info
2021-10-04 16:15:49.391866 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:15:49.397800 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop table if exists "dellstore"."public"."actors__dbt_tmp" cascade
2021-10-04 16:15:49.403522 (Thread-2): Opening a new connection, currently in state init
2021-10-04 16:15:49.403899 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:15:49.404697 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_tmp" cascade
2021-10-04 16:15:49.405138 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 16:15:49.413812 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-04 16:15:49.414340 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2021-10-04 16:15:49.417359 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:15:49.420852 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:15:49.421570 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-04 16:15:49.422166 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop table if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-04 16:15:49.423003 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-04 16:15:49.423420 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-04 16:15:49.444766 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-04 16:15:49.445201 (Thread-2): Writing runtime SQL for node "model.my_new_project.actors"
2021-10-04 16:15:49.453978 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:15:49.454646 (Thread-2): On model.my_new_project.actors: BEGIN
2021-10-04 16:15:49.455701 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:15:49.456457 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:15:49.457053 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:15:49.457414 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */


  create  table "dellstore"."public"."actors__dbt_tmp"
  as (
    -- 

SELECT nested.first_name, nested.movie_number, nested.movie_prices FROM (
SELECT actor, SUBSTRING(actor, 1, POSITION(' ' in actor)) as first_name, 
actor, COUNT(*) as movie_number,
actor, SUM(price) as movie_prices
FROM "dellstore"."public"."products" 
GROUP BY actor
) nested

ORDER BY movie_prices DESC
  );
2021-10-04 16:15:49.458362 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-10-04 16:15:49.459950 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:15:49.460553 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:15:49.461140 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "dellstore"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-10-04 16:15:49.469336 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-10-04 16:15:49.484777 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:15:49.485429 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-10-04 16:15:49.508090 (Thread-1): SQL status: ALTER TABLE in 0.02 seconds
2021-10-04 16:15:49.515703 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:15:49.516396 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-10-04 16:15:49.517742 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:15:49.534648 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-04 16:15:49.535257 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:15:49.535791 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-04 16:15:49.538810 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:15:49.550951 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:15:49.551541 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-04 16:15:49.563641 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-04 16:15:49.568049 (Thread-1): finished collecting timing info
2021-10-04 16:15:49.569032 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-10-04 16:15:49.570643 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f47eb0c-001a-4d8a-aa61-d67e1b73fb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd238726250>]}
2021-10-04 16:15:49.572745 (Thread-1): 16:15:49 | 1 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.29s]
2021-10-04 16:15:49.573376 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-10-04 16:15:49.574790 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-10-04 16:15:49.578086 (Thread-1): 16:15:49 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2021-10-04 16:15:49.579214 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:15:49.579861 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-10-04 16:15:49.594139 (Thread-2): SQL status: SELECT 8802 in 0.13 seconds
2021-10-04 16:15:49.599230 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-04 16:15:49.607519 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:15:49.608441 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors" rename to "actors__dbt_backup"
2021-10-04 16:15:49.609896 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:15:49.615654 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:15:49.616349 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors__dbt_tmp" rename to "actors"
2021-10-04 16:15:49.617512 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:15:49.620127 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-04 16:15:49.620760 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:15:49.621217 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-04 16:15:49.623620 (Thread-1): finished collecting timing info
2021-10-04 16:15:49.639897 (Thread-2): SQL status: COMMIT in 0.02 seconds
2021-10-04 16:15:49.648173 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:15:49.654401 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop table if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-04 16:15:49.660377 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:15:49.661068 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_tmp" cascade
2021-10-04 16:15:49.661596 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 16:15:49.665550 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-04 16:15:49.666059 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 16:15:49.669500 (Thread-2): finished collecting timing info
2021-10-04 16:15:49.672940 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:15:49.673489 (Thread-2): On model.my_new_project.actors: Close
2021-10-04 16:15:49.674034 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-04 16:15:49.675354 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f47eb0c-001a-4d8a-aa61-d67e1b73fb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd239813940>]}
2021-10-04 16:15:49.677507 (Thread-2): 16:15:49 | 2 of 3 OK created table model public.actors.......................... [SELECT 8802 in 0.40s]
2021-10-04 16:15:49.677711 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 16:15:49.678074 (Thread-2): Finished running node model.my_new_project.actors
2021-10-04 16:15:49.704369 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-04 16:15:49.725241 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:15:49.726494 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-10-04 16:15:49.727824 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:15:49.728609 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:15:49.729238 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "dellstore"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dellstore"."public"."my_first_dbt_model"
where id = 1
  );

2021-10-04 16:15:49.733355 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-10-04 16:15:49.737038 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:15:49.737537 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "dellstore"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-10-04 16:15:49.738457 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:15:49.740097 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-04 16:15:49.740512 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:15:49.740844 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-04 16:15:49.743630 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:15:49.746480 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:15:49.746880 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-04 16:15:49.747621 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 16:15:49.751117 (Thread-1): finished collecting timing info
2021-10-04 16:15:49.751721 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-10-04 16:15:49.752840 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f47eb0c-001a-4d8a-aa61-d67e1b73fb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2386ee520>]}
2021-10-04 16:15:49.754492 (Thread-1): 16:15:49 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.17s]
2021-10-04 16:15:49.754922 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-10-04 16:15:49.757245 (MainThread): Acquiring new postgres connection "master".
2021-10-04 16:15:49.757875 (MainThread): Using postgres connection "master".
2021-10-04 16:15:49.758389 (MainThread): On master: BEGIN
2021-10-04 16:15:49.758898 (MainThread): Opening a new connection, currently in state closed
2021-10-04 16:15:49.769558 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-04 16:15:49.770084 (MainThread): On master: COMMIT
2021-10-04 16:15:49.770521 (MainThread): Using postgres connection "master".
2021-10-04 16:15:49.770949 (MainThread): On master: COMMIT
2021-10-04 16:15:49.771889 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:15:49.772412 (MainThread): On master: Close
2021-10-04 16:15:49.773399 (MainThread): 16:15:49 | 
2021-10-04 16:15:49.773966 (MainThread): 16:15:49 | Finished running 2 table models, 1 view model in 0.67s.
2021-10-04 16:15:49.774507 (MainThread): Connection 'master' was properly closed.
2021-10-04 16:15:49.775073 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-10-04 16:15:49.775753 (MainThread): Connection 'model.my_new_project.actors' was properly closed.
2021-10-04 16:15:49.845252 (MainThread): 
2021-10-04 16:15:49.846022 (MainThread): Completed successfully
2021-10-04 16:15:49.846616 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-04 16:15:49.847592 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2386d9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2386d6fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2386cd520>]}
2021-10-04 16:15:49.848625 (MainThread): Flushing usage events
2021-10-04 16:16:42.912307 (MainThread): Running with dbt=0.19.0
2021-10-04 16:16:43.304319 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 16:16:43.313518 (MainThread): Tracking: tracking
2021-10-04 16:16:43.319445 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f718bb6bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f718f172400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f718bb7c0d0>]}
2021-10-04 16:16:43.437516 (MainThread): Partial parsing not enabled
2021-10-04 16:16:43.443949 (MainThread): Parsing macros/adapters.sql
2021-10-04 16:16:43.528308 (MainThread): Parsing macros/catalog.sql
2021-10-04 16:16:43.535981 (MainThread): Parsing macros/relations.sql
2021-10-04 16:16:43.541663 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 16:16:43.549372 (MainThread): Parsing macros/core.sql
2021-10-04 16:16:43.561072 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 16:16:43.872458 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 16:16:43.890540 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 16:16:43.899072 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 16:16:43.934174 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 16:16:43.939209 (MainThread): Parsing macros/etc/query.sql
2021-10-04 16:16:43.942604 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 16:16:43.945582 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 16:16:43.975860 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 16:16:44.050510 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 16:16:44.060392 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 16:16:44.356747 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 16:16:44.507316 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 16:16:44.590000 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 16:16:44.612845 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 16:16:44.735562 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 16:16:44.788833 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 16:16:44.856978 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 16:16:44.922518 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 16:16:44.935141 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 16:16:44.945869 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 16:16:44.959990 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 16:16:45.028054 (MainThread): Partial parsing not enabled
2021-10-04 16:16:45.233203 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 16:16:45.341186 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:16:45.386086 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:16:45.450155 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:16:46.065631 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20fd6685-9475-48c5-be63-87c42fe81765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f718b903c70>]}
2021-10-04 16:16:46.241789 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-04 16:16:46.245771 (MainThread): Found 3 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-04 16:16:46.250301 (MainThread): 
2021-10-04 16:16:46.252336 (MainThread): Acquiring new postgres connection "master".
2021-10-04 16:16:46.271468 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-04 16:16:46.306457 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-04 16:16:46.307490 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-04 16:16:46.308470 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-04 16:16:46.323109 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-04 16:16:46.330224 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-04 16:16:46.350551 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-04 16:16:46.376340 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 16:16:46.378125 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-04 16:16:46.379687 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-04 16:16:46.393985 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-04 16:16:46.395575 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 16:16:46.396991 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-04 16:16:46.409184 (ThreadPoolExecutor-1_0): SQL status: SELECT 12 in 0.01 seconds
2021-10-04 16:16:46.463670 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-04 16:16:46.466077 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-04 16:16:46.519219 (MainThread): Using postgres connection "master".
2021-10-04 16:16:46.521068 (MainThread): On master: BEGIN
2021-10-04 16:16:46.522545 (MainThread): Opening a new connection, currently in state init
2021-10-04 16:16:46.535298 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-04 16:16:46.537155 (MainThread): Using postgres connection "master".
2021-10-04 16:16:46.538881 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-04 16:16:46.589524 (MainThread): SQL status: SELECT 1 in 0.05 seconds
2021-10-04 16:16:46.627256 (MainThread): On master: ROLLBACK
2021-10-04 16:16:46.630111 (MainThread): Using postgres connection "master".
2021-10-04 16:16:46.635137 (MainThread): On master: BEGIN
2021-10-04 16:16:46.637405 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:16:46.638542 (MainThread): On master: COMMIT
2021-10-04 16:16:46.640994 (MainThread): Using postgres connection "master".
2021-10-04 16:16:46.643019 (MainThread): On master: COMMIT
2021-10-04 16:16:46.644591 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:16:46.645604 (MainThread): On master: Close
2021-10-04 16:16:46.647122 (MainThread): 16:16:46 | Concurrency: 2 threads (target='dev')
2021-10-04 16:16:46.648198 (MainThread): 16:16:46 | 
2021-10-04 16:16:46.654468 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-10-04 16:16:46.655035 (Thread-2): Began running node model.my_new_project.actors
2021-10-04 16:16:46.657788 (Thread-1): 16:16:46 | 1 of 3 START table model public.my_first_dbt_model................... [RUN]
2021-10-04 16:16:46.661180 (Thread-2): 16:16:46 | 2 of 3 START table model public.actors............................... [RUN]
2021-10-04 16:16:46.662531 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:16:46.663546 (Thread-2): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 16:16:46.664065 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-10-04 16:16:46.664905 (Thread-2): Compiling model.my_new_project.actors
2021-10-04 16:16:46.716342 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-04 16:16:46.724723 (Thread-2): Writing injected SQL for node "model.my_new_project.actors"
2021-10-04 16:16:46.736097 (Thread-2): finished collecting timing info
2021-10-04 16:16:46.754315 (Thread-1): finished collecting timing info
2021-10-04 16:16:47.050927 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:16:47.052972 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:16:47.053744 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop table if exists "dellstore"."public"."actors__dbt_tmp" cascade
2021-10-04 16:16:47.055166 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_tmp" cascade
2021-10-04 16:16:47.056713 (Thread-2): Opening a new connection, currently in state init
2021-10-04 16:16:47.058059 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 16:16:47.077487 (Thread-2): SQL status: DROP TABLE in 0.02 seconds
2021-10-04 16:16:47.085186 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-10-04 16:16:47.100765 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:16:47.107892 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop table if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-04 16:16:47.108588 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:16:47.110515 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-04 16:16:47.111162 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-04 16:16:47.118271 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-04 16:16:47.227658 (Thread-2): Writing runtime SQL for node "model.my_new_project.actors"
2021-10-04 16:16:47.254034 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-04 16:16:47.275859 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:16:47.277749 (Thread-2): On model.my_new_project.actors: BEGIN
2021-10-04 16:16:47.280948 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:16:47.283163 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:16:47.285365 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */


  create  table "dellstore"."public"."actors__dbt_tmp"
  as (
    -- 

SELECT nested.first_name, nested.movie_number, nested.movie_prices FROM (
SELECT actor, SUBSTRING(actor, 1, POSITION(' ' in actor)) as first_name, 
actor, COUNT(*) as movie_number,
actor, SUM(price) as movie_prices
FROM "dellstore"."public"."products" 
GROUP BY actor
) nested

ORDER BY movie_prices DESC
  );
2021-10-04 16:16:47.292516 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:16:47.294526 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-10-04 16:16:47.297541 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:16:47.299706 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:16:47.302931 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "dellstore"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-10-04 16:16:47.319463 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-10-04 16:16:47.376311 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:16:47.377889 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-10-04 16:16:47.381154 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:16:47.397968 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:16:47.399498 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-10-04 16:16:47.401951 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:16:47.431090 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-04 16:16:47.432042 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:16:47.432701 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-04 16:16:47.442794 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-04 16:16:47.451499 (Thread-2): SQL status: SELECT 8802 in 0.16 seconds
2021-10-04 16:16:47.451728 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:16:47.461867 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:16:47.462876 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-04 16:16:47.463787 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors" rename to "actors__dbt_backup"
2021-10-04 16:16:47.465658 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:16:47.470821 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:16:47.471331 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors__dbt_tmp" rename to "actors"
2021-10-04 16:16:47.472477 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:16:47.474608 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-04 16:16:47.474841 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-04 16:16:47.475087 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:16:47.480038 (Thread-1): finished collecting timing info
2021-10-04 16:16:47.480820 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-04 16:16:47.481544 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-10-04 16:16:47.483726 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20fd6685-9475-48c5-be63-87c42fe81765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7188fd1d30>]}
2021-10-04 16:16:47.486036 (Thread-1): 16:16:47 | 1 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.82s]
2021-10-04 16:16:47.486264 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:16:47.486729 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-10-04 16:16:47.490684 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:16:47.492110 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-10-04 16:16:47.492384 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop table if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-04 16:16:47.494363 (Thread-1): 16:16:47 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2021-10-04 16:16:47.495715 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:16:47.496272 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-10-04 16:16:47.503753 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2021-10-04 16:16:47.512715 (Thread-2): finished collecting timing info
2021-10-04 16:16:47.513896 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-04 16:16:47.514141 (Thread-2): On model.my_new_project.actors: Close
2021-10-04 16:16:47.515983 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20fd6685-9475-48c5-be63-87c42fe81765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7188fea9d0>]}
2021-10-04 16:16:47.518729 (Thread-2): 16:16:47 | 2 of 3 OK created table model public.actors.......................... [SELECT 8802 in 0.85s]
2021-10-04 16:16:47.519315 (Thread-2): Finished running node model.my_new_project.actors
2021-10-04 16:16:47.525870 (Thread-1): finished collecting timing info
2021-10-04 16:16:47.569515 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:16:47.570400 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_tmp" cascade
2021-10-04 16:16:47.571023 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 16:16:47.582730 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-04 16:16:47.597835 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:16:47.599302 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-04 16:16:47.601659 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 16:16:47.654218 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-04 16:16:47.694169 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:16:47.695584 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-10-04 16:16:47.698564 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:16:47.700269 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:16:47.702398 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "dellstore"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dellstore"."public"."my_first_dbt_model"
where id = 1
  );

2021-10-04 16:16:47.712553 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-04 16:16:47.733275 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:16:47.735136 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "dellstore"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-10-04 16:16:47.738197 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:16:47.747104 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-04 16:16:47.748939 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:16:47.750392 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-04 16:16:47.783321 (Thread-1): SQL status: COMMIT in 0.03 seconds
2021-10-04 16:16:47.797467 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:16:47.799257 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-04 16:16:47.801920 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 16:16:47.820146 (Thread-1): finished collecting timing info
2021-10-04 16:16:47.822454 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-10-04 16:16:47.828393 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20fd6685-9475-48c5-be63-87c42fe81765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7188f9e9d0>]}
2021-10-04 16:16:47.836825 (Thread-1): 16:16:47 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.33s]
2021-10-04 16:16:47.838935 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-10-04 16:16:47.853392 (MainThread): Acquiring new postgres connection "master".
2021-10-04 16:16:47.854896 (MainThread): Using postgres connection "master".
2021-10-04 16:16:47.856090 (MainThread): On master: BEGIN
2021-10-04 16:16:47.857220 (MainThread): Opening a new connection, currently in state closed
2021-10-04 16:16:47.871132 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-04 16:16:47.873682 (MainThread): On master: COMMIT
2021-10-04 16:16:47.876192 (MainThread): Using postgres connection "master".
2021-10-04 16:16:47.878373 (MainThread): On master: COMMIT
2021-10-04 16:16:47.882130 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:16:47.883990 (MainThread): On master: Close
2021-10-04 16:16:47.886775 (MainThread): 16:16:47 | 
2021-10-04 16:16:47.888538 (MainThread): 16:16:47 | Finished running 2 table models, 1 view model in 1.63s.
2021-10-04 16:16:47.890523 (MainThread): Connection 'master' was properly closed.
2021-10-04 16:16:47.894531 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-10-04 16:16:47.897735 (MainThread): Connection 'model.my_new_project.actors' was properly closed.
2021-10-04 16:16:48.093179 (MainThread): 
2021-10-04 16:16:48.094786 (MainThread): Completed successfully
2021-10-04 16:16:48.095994 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-04 16:16:48.097623 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7188ffb400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7188fa89a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7188fa8c40>]}
2021-10-04 16:16:48.098821 (MainThread): Flushing usage events
2021-10-04 16:17:09.755153 (MainThread): Running with dbt=0.19.0
2021-10-04 16:17:10.311686 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-04 16:17:10.328505 (MainThread): Tracking: tracking
2021-10-04 16:17:10.342925 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2a1dd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2d7e4460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2a1ee130>]}
2021-10-04 16:17:10.512995 (MainThread): Partial parsing not enabled
2021-10-04 16:17:10.528752 (MainThread): Parsing macros/adapters.sql
2021-10-04 16:17:10.677384 (MainThread): Parsing macros/catalog.sql
2021-10-04 16:17:10.696632 (MainThread): Parsing macros/relations.sql
2021-10-04 16:17:10.713385 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-04 16:17:10.729459 (MainThread): Parsing macros/core.sql
2021-10-04 16:17:10.760216 (MainThread): Parsing macros/adapters/common.sql
2021-10-04 16:17:11.010410 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-04 16:17:11.017476 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-04 16:17:11.022686 (MainThread): Parsing macros/etc/datetime.sql
2021-10-04 16:17:11.066902 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-04 16:17:11.076011 (MainThread): Parsing macros/etc/query.sql
2021-10-04 16:17:11.081379 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-04 16:17:11.086322 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-04 16:17:11.137748 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-04 16:17:11.257476 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-04 16:17:11.266203 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-04 16:17:11.401323 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-04 16:17:11.435232 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-04 16:17:11.448790 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-04 16:17:11.454261 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-04 16:17:11.496002 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-04 16:17:11.511342 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-04 16:17:11.530110 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-04 16:17:11.548397 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-04 16:17:11.555490 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-04 16:17:11.559901 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-04 16:17:11.565699 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-04 16:17:11.596119 (MainThread): Partial parsing not enabled
2021-10-04 16:17:11.693425 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 16:17:11.771427 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:17:11.835027 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:17:12.067133 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-04 16:17:13.058129 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd47d4b5c-2ee4-426e-b858-8b9a6b81e3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a29f73b80>]}
2021-10-04 16:17:13.306473 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-04 16:17:13.337455 (MainThread): Found 3 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-04 16:17:13.340182 (MainThread): 
2021-10-04 16:17:13.341924 (MainThread): Acquiring new postgres connection "master".
2021-10-04 16:17:13.359655 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-04 16:17:13.383671 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-04 16:17:13.384315 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-04 16:17:13.384767 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-04 16:17:13.396761 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-04 16:17:13.401318 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-04 16:17:13.416645 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-04 16:17:13.436365 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 16:17:13.437363 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-04 16:17:13.438272 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-04 16:17:13.454179 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2021-10-04 16:17:13.456472 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-04 16:17:13.462552 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-04 16:17:13.472344 (ThreadPoolExecutor-1_0): SQL status: SELECT 12 in 0.01 seconds
2021-10-04 16:17:13.507648 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-04 16:17:13.509546 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-04 16:17:13.523423 (MainThread): Using postgres connection "master".
2021-10-04 16:17:13.524184 (MainThread): On master: BEGIN
2021-10-04 16:17:13.524788 (MainThread): Opening a new connection, currently in state init
2021-10-04 16:17:13.529491 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:17:13.530215 (MainThread): Using postgres connection "master".
2021-10-04 16:17:13.530776 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-04 16:17:13.537137 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2021-10-04 16:17:13.540642 (MainThread): On master: ROLLBACK
2021-10-04 16:17:13.541590 (MainThread): Using postgres connection "master".
2021-10-04 16:17:13.542114 (MainThread): On master: BEGIN
2021-10-04 16:17:13.543204 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:17:13.543800 (MainThread): On master: COMMIT
2021-10-04 16:17:13.544453 (MainThread): Using postgres connection "master".
2021-10-04 16:17:13.545095 (MainThread): On master: COMMIT
2021-10-04 16:17:13.546088 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:17:13.546823 (MainThread): On master: Close
2021-10-04 16:17:13.548234 (MainThread): 16:17:13 | Concurrency: 2 threads (target='dev')
2021-10-04 16:17:13.549199 (MainThread): 16:17:13 | 
2021-10-04 16:17:13.559211 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-10-04 16:17:13.560038 (Thread-2): Began running node model.my_new_project.actors
2021-10-04 16:17:13.563656 (Thread-1): 16:17:13 | 1 of 3 START table model public.my_first_dbt_model................... [RUN]
2021-10-04 16:17:13.567869 (Thread-2): 16:17:13 | 2 of 3 START view model public.actors................................ [RUN]
2021-10-04 16:17:13.569823 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:17:13.571201 (Thread-2): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-04 16:17:13.571750 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-10-04 16:17:13.573029 (Thread-2): Compiling model.my_new_project.actors
2021-10-04 16:17:13.700560 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-04 16:17:13.712968 (Thread-2): Writing injected SQL for node "model.my_new_project.actors"
2021-10-04 16:17:13.733543 (Thread-2): finished collecting timing info
2021-10-04 16:17:13.753313 (Thread-1): finished collecting timing info
2021-10-04 16:17:14.038236 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:17:14.040459 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:17:14.040763 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_tmp" cascade
2021-10-04 16:17:14.041454 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop view if exists "dellstore"."public"."actors__dbt_tmp" cascade
2021-10-04 16:17:14.042043 (Thread-1): Opening a new connection, currently in state closed
2021-10-04 16:17:14.042757 (Thread-2): Opening a new connection, currently in state init
2021-10-04 16:17:14.049003 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-04 16:17:14.049344 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-04 16:17:14.056072 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:17:14.060642 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:17:14.061451 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-04 16:17:14.062096 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop table if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-04 16:17:14.063682 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-04 16:17:14.064533 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-04 16:17:14.082296 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-04 16:17:14.086906 (Thread-2): Writing runtime SQL for node "model.my_new_project.actors"
2021-10-04 16:17:14.096784 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:17:14.097636 (Thread-2): On model.my_new_project.actors: BEGIN
2021-10-04 16:17:14.098736 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:17:14.099578 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:17:14.100563 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:17:14.100877 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */

  create view "dellstore"."public"."actors__dbt_tmp" as (
    -- dbt 
SELECT nested.first_name, nested.movie_number, nested.movie_prices FROM (
SELECT actor, SUBSTRING(actor, 1, POSITION(' ' in actor)) as first_name, 
actor, COUNT(*) as movie_number,
actor, SUM(price) as movie_prices
FROM "dellstore"."public"."products" 
GROUP BY actor
) nested

ORDER BY movie_prices DESC
  );

2021-10-04 16:17:14.101716 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-10-04 16:17:14.103532 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:17:14.104869 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:17:14.105863 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "dellstore"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-10-04 16:17:14.109992 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-10-04 16:17:14.122091 (Thread-2): SQL status: CREATE VIEW in 0.02 seconds
2021-10-04 16:17:14.145917 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:17:14.146953 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:17:14.147205 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-10-04 16:17:14.148010 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors" rename to "actors__dbt_backup"
2021-10-04 16:17:14.149676 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:17:14.150160 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:17:14.155610 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:17:14.161329 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:17:14.162046 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-10-04 16:17:14.162661 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors__dbt_tmp" rename to "actors"
2021-10-04 16:17:14.164180 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:17:14.164748 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:17:14.185580 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-04 16:17:14.190673 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-04 16:17:14.190954 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:17:14.191660 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:17:14.192206 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-04 16:17:14.192724 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-04 16:17:14.196135 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:17:14.204753 (Thread-2): SQL status: COMMIT in 0.01 seconds
2021-10-04 16:17:14.226325 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-04 16:17:14.227292 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-04 16:17:14.228955 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop table if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-04 16:17:14.230747 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-04 16:17:14.240917 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2021-10-04 16:17:14.250753 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-10-04 16:17:14.268412 (Thread-2): finished collecting timing info
2021-10-04 16:17:14.283128 (Thread-2): On model.my_new_project.actors: Close
2021-10-04 16:17:14.300288 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd47d4b5c-2ee4-426e-b858-8b9a6b81e3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a29f5d490>]}
2021-10-04 16:17:14.295659 (Thread-1): finished collecting timing info
2021-10-04 16:17:14.316263 (Thread-2): 16:17:14 | 2 of 3 OK created view model public.actors........................... [CREATE VIEW in 0.73s]
2021-10-04 16:17:14.317491 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-10-04 16:17:14.320138 (Thread-2): Finished running node model.my_new_project.actors
2021-10-04 16:17:14.327798 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd47d4b5c-2ee4-426e-b858-8b9a6b81e3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a28645220>]}
2021-10-04 16:17:14.354219 (Thread-1): 16:17:14 | 1 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.76s]
2021-10-04 16:17:14.358578 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-10-04 16:17:14.365143 (Thread-2): Began running node model.my_new_project.my_second_dbt_model
2021-10-04 16:17:14.393105 (Thread-2): 16:17:14 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2021-10-04 16:17:14.396188 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:17:14.402691 (Thread-2): Compiling model.my_new_project.my_second_dbt_model
2021-10-04 16:17:14.442846 (Thread-2): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-04 16:17:14.459245 (Thread-2): finished collecting timing info
2021-10-04 16:17:14.477185 (Thread-2): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:17:14.477910 (Thread-2): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_tmp" cascade
2021-10-04 16:17:14.478477 (Thread-2): Opening a new connection, currently in state closed
2021-10-04 16:17:14.484973 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-04 16:17:14.490463 (Thread-2): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:17:14.491150 (Thread-2): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-04 16:17:14.492072 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 16:17:14.495006 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-04 16:17:14.509640 (Thread-2): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:17:14.510686 (Thread-2): On model.my_new_project.my_second_dbt_model: BEGIN
2021-10-04 16:17:14.512349 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-04 16:17:14.513294 (Thread-2): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:17:14.514366 (Thread-2): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "dellstore"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dellstore"."public"."my_first_dbt_model"
where id = 1
  );

2021-10-04 16:17:14.520856 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-10-04 16:17:14.534288 (Thread-2): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:17:14.535655 (Thread-2): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "dellstore"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-10-04 16:17:14.538278 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-04 16:17:14.544197 (Thread-2): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-04 16:17:14.545851 (Thread-2): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:17:14.547323 (Thread-2): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-04 16:17:14.553104 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:17:14.563561 (Thread-2): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-04 16:17:14.565282 (Thread-2): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-04 16:17:14.567679 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-04 16:17:14.581236 (Thread-2): finished collecting timing info
2021-10-04 16:17:14.583505 (Thread-2): On model.my_new_project.my_second_dbt_model: Close
2021-10-04 16:17:14.587802 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd47d4b5c-2ee4-426e-b858-8b9a6b81e3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a28635d30>]}
2021-10-04 16:17:14.594829 (Thread-2): 16:17:14 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.19s]
2021-10-04 16:17:14.596552 (Thread-2): Finished running node model.my_new_project.my_second_dbt_model
2021-10-04 16:17:14.605631 (MainThread): Acquiring new postgres connection "master".
2021-10-04 16:17:14.607591 (MainThread): Using postgres connection "master".
2021-10-04 16:17:14.609137 (MainThread): On master: BEGIN
2021-10-04 16:17:14.610510 (MainThread): Opening a new connection, currently in state closed
2021-10-04 16:17:14.625050 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-04 16:17:14.626696 (MainThread): On master: COMMIT
2021-10-04 16:17:14.629028 (MainThread): Using postgres connection "master".
2021-10-04 16:17:14.630656 (MainThread): On master: COMMIT
2021-10-04 16:17:14.633750 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-04 16:17:14.635708 (MainThread): On master: Close
2021-10-04 16:17:14.638759 (MainThread): 16:17:14 | 
2021-10-04 16:17:14.640399 (MainThread): 16:17:14 | Finished running 2 view models, 1 table model in 1.30s.
2021-10-04 16:17:14.642324 (MainThread): Connection 'master' was properly closed.
2021-10-04 16:17:14.644058 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2021-10-04 16:17:14.646322 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-10-04 16:17:14.951379 (MainThread): 
2021-10-04 16:17:14.952986 (MainThread): Completed successfully
2021-10-04 16:17:14.955732 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-04 16:17:14.958954 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a28622760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a285ccfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a285cd490>]}
2021-10-04 16:17:14.962363 (MainThread): Flushing usage events
2021-10-06 10:59:59.727702 (MainThread): Running with dbt=0.19.0
2021-10-06 11:00:00.234255 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 11:00:00.242532 (MainThread): Tracking: tracking
2021-10-06 11:00:00.246980 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cff09b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d026a2430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cff0ad100>]}
2021-10-06 11:00:00.322543 (MainThread): Partial parsing not enabled
2021-10-06 11:00:00.332375 (MainThread): Parsing macros/adapters.sql
2021-10-06 11:00:00.423197 (MainThread): Parsing macros/catalog.sql
2021-10-06 11:00:00.435264 (MainThread): Parsing macros/relations.sql
2021-10-06 11:00:00.442880 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 11:00:00.462149 (MainThread): Parsing macros/core.sql
2021-10-06 11:00:00.480305 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 11:00:00.634348 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 11:00:00.641108 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 11:00:00.646152 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 11:00:00.680938 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 11:00:00.689563 (MainThread): Parsing macros/etc/query.sql
2021-10-06 11:00:00.694858 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 11:00:00.700292 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 11:00:00.742069 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 11:00:00.810634 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 11:00:00.817245 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 11:00:00.907159 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 11:00:00.962933 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 11:00:00.989163 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 11:00:00.997670 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 11:00:01.052013 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 11:00:01.070463 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 11:00:01.095292 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 11:00:01.125353 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 11:00:01.133952 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 11:00:01.141186 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 11:00:01.151090 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 11:00:01.195869 (MainThread): Partial parsing not enabled
2021-10-06 11:00:01.379411 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-06 11:00:01.464749 (MainThread): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-06 11:00:01.524622 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:00:01.581720 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:00:01.665274 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-06 11:00:02.403633 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cfee684f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cfee5a070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cfee704c0>]}
2021-10-06 11:00:02.404853 (MainThread): Flushing usage events
2021-10-06 11:00:03.514831 (MainThread): Connection 'snapshot.my_new_project.actors_snapshot' was properly closed.
2021-10-06 11:00:03.518749 (MainThread): Encountered an error:
2021-10-06 11:00:03.520710 (MainThread): Compilation Error in model luhn (models/luhn.sql)
  Model 'model.my_new_project.luhn' (models/luhn.sql) depends on a source named 'dellstore_dataset.cutomers' which was not found
2021-10-06 11:00:03.542376 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 379, in process_manifest
    process_sources(manifest, project_name)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 812, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 795, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 498, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model luhn (models/luhn.sql)
  Model 'model.my_new_project.luhn' (models/luhn.sql) depends on a source named 'dellstore_dataset.cutomers' which was not found

2021-10-06 11:00:23.269225 (MainThread): Running with dbt=0.19.0
2021-10-06 11:00:23.581185 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 11:00:23.588444 (MainThread): Tracking: tracking
2021-10-06 11:00:23.594077 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096e3befa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09719c33a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096e3cd070>]}
2021-10-06 11:00:23.699974 (MainThread): Partial parsing not enabled
2021-10-06 11:00:23.707403 (MainThread): Parsing macros/adapters.sql
2021-10-06 11:00:23.767555 (MainThread): Parsing macros/catalog.sql
2021-10-06 11:00:23.776849 (MainThread): Parsing macros/relations.sql
2021-10-06 11:00:23.782502 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 11:00:23.792661 (MainThread): Parsing macros/core.sql
2021-10-06 11:00:23.808051 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 11:00:23.945227 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 11:00:23.951085 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 11:00:23.956585 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 11:00:23.995622 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 11:00:24.003057 (MainThread): Parsing macros/etc/query.sql
2021-10-06 11:00:24.007986 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 11:00:24.012384 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 11:00:24.053238 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 11:00:24.169633 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 11:00:24.180765 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 11:00:24.369890 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 11:00:24.454363 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 11:00:24.482215 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 11:00:24.487321 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 11:00:24.528884 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 11:00:24.546022 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 11:00:24.570407 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 11:00:24.600746 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 11:00:24.608191 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 11:00:24.615007 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 11:00:24.623169 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 11:00:24.667864 (MainThread): Partial parsing not enabled
2021-10-06 11:00:24.810305 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-06 11:00:24.895412 (MainThread): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-06 11:00:24.953979 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:00:25.010126 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:00:25.095763 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-06 11:00:25.867789 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5c48642-09d9-4f98-af0c-6ba4039f21a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096e129c40>]}
2021-10-06 11:00:26.023141 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 11:00:26.027455 (MainThread): Found 4 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-06 11:00:26.035557 (MainThread): 
2021-10-06 11:00:26.037966 (MainThread): Acquiring new postgres connection "master".
2021-10-06 11:00:26.064495 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 11:00:26.103492 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 11:00:26.104592 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 11:00:26.105611 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 11:00:26.138838 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.03 seconds
2021-10-06 11:00:26.148216 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 11:00:26.175812 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 11:00:26.197853 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 11:00:26.198949 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 11:00:26.199918 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 11:00:26.208969 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:00:26.210095 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 11:00:26.211217 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 11:00:26.225916 (ThreadPoolExecutor-1_0): SQL status: SELECT 12 in 0.01 seconds
2021-10-06 11:00:26.267587 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 11:00:26.269374 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 11:00:26.306076 (MainThread): Using postgres connection "master".
2021-10-06 11:00:26.307361 (MainThread): On master: BEGIN
2021-10-06 11:00:26.308549 (MainThread): Opening a new connection, currently in state init
2021-10-06 11:00:26.317563 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:00:26.318685 (MainThread): Using postgres connection "master".
2021-10-06 11:00:26.320086 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 11:00:26.345498 (MainThread): SQL status: SELECT 2 in 0.02 seconds
2021-10-06 11:00:26.355412 (MainThread): On master: ROLLBACK
2021-10-06 11:00:26.357157 (MainThread): Using postgres connection "master".
2021-10-06 11:00:26.358121 (MainThread): On master: BEGIN
2021-10-06 11:00:26.360291 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:00:26.361671 (MainThread): On master: COMMIT
2021-10-06 11:00:26.362793 (MainThread): Using postgres connection "master".
2021-10-06 11:00:26.363808 (MainThread): On master: COMMIT
2021-10-06 11:00:26.365536 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:00:26.366587 (MainThread): On master: Close
2021-10-06 11:00:26.368116 (MainThread): 11:00:26 | Concurrency: 2 threads (target='dev')
2021-10-06 11:00:26.369327 (MainThread): 11:00:26 | 
2021-10-06 11:00:26.384952 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-10-06 11:00:26.385874 (Thread-2): Began running node model.my_new_project.actors
2021-10-06 11:00:26.391480 (Thread-1): 11:00:26 | 1 of 4 START table model public.my_first_dbt_model................... [RUN]
2021-10-06 11:00:26.397941 (Thread-2): 11:00:26 | 2 of 4 START view model public.actors................................ [RUN]
2021-10-06 11:00:26.400530 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:00:26.402247 (Thread-2): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-06 11:00:26.403245 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-10-06 11:00:26.405790 (Thread-2): Compiling model.my_new_project.actors
2021-10-06 11:00:26.494995 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-06 11:00:26.500952 (Thread-2): Writing injected SQL for node "model.my_new_project.actors"
2021-10-06 11:00:26.515295 (Thread-2): finished collecting timing info
2021-10-06 11:00:26.542348 (Thread-1): finished collecting timing info
2021-10-06 11:00:26.701065 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:00:26.706716 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:00:26.707356 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop view if exists "dellstore"."public"."actors__dbt_tmp" cascade
2021-10-06 11:00:26.708897 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_tmp" cascade
2021-10-06 11:00:26.710403 (Thread-2): Opening a new connection, currently in state init
2021-10-06 11:00:26.712016 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:00:26.725873 (Thread-2): SQL status: DROP VIEW in 0.02 seconds
2021-10-06 11:00:26.726465 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 11:00:26.737803 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:00:26.748240 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:00:26.748999 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop view if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-06 11:00:26.750448 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-06 11:00:26.752738 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:00:26.754240 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 11:00:26.785061 (Thread-2): Writing runtime SQL for node "model.my_new_project.actors"
2021-10-06 11:00:26.803415 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-06 11:00:26.820175 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:00:26.821613 (Thread-2): On model.my_new_project.actors: BEGIN
2021-10-06 11:00:26.824060 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:00:26.825803 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:00:26.827258 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */

  create view "dellstore"."public"."actors__dbt_tmp" as (
    -- dbt 
SELECT nested.first_name, nested.movie_number, nested.movie_prices FROM (
SELECT actor, SUBSTRING(actor, 1, POSITION(' ' in actor)) as first_name, 
actor, COUNT(*) as movie_number,
actor, SUM(price) as movie_prices
FROM "dellstore"."public"."products" 
GROUP BY actor
) nested

ORDER BY movie_prices DESC
  );

2021-10-06 11:00:26.833802 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:00:26.835606 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-10-06 11:00:26.837942 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:00:26.840042 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:00:26.842149 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "dellstore"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-10-06 11:00:26.871127 (Thread-1): SQL status: SELECT 2 in 0.03 seconds
2021-10-06 11:00:26.886008 (Thread-2): SQL status: CREATE VIEW in 0.06 seconds
2021-10-06 11:00:26.923289 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:00:26.930060 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-10-06 11:00:26.935300 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:00:26.937292 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors" rename to "actors__dbt_backup"
2021-10-06 11:00:26.938907 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:00:26.948259 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:00:26.949016 (Thread-2): SQL status: ALTER TABLE in 0.01 seconds
2021-10-06 11:00:26.949708 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-10-06 11:00:26.957641 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:00:26.958821 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors__dbt_tmp" rename to "actors"
2021-10-06 11:00:26.959321 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:00:26.966618 (Thread-2): SQL status: ALTER TABLE in 0.01 seconds
2021-10-06 11:00:26.997712 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-06 11:00:26.998112 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-06 11:00:26.998949 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:00:27.000162 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:00:27.001195 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-06 11:00:27.002192 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-06 11:00:27.007210 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:00:27.018400 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:00:27.018938 (Thread-1): SQL status: COMMIT in 0.02 seconds
2021-10-06 11:00:27.019737 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop view if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-06 11:00:27.026927 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:00:27.028196 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-06 11:00:27.039682 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:00:27.048739 (Thread-2): finished collecting timing info
2021-10-06 11:00:27.050056 (Thread-2): On model.my_new_project.actors: Close
2021-10-06 11:00:27.053046 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c48642-09d9-4f98-af0c-6ba4039f21a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095f7cc190>]}
2021-10-06 11:00:27.053547 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-10-06 11:00:27.057313 (Thread-2): 11:00:27 | 2 of 4 OK created view model public.actors........................... [CREATE VIEW in 0.65s]
2021-10-06 11:00:27.066414 (Thread-1): finished collecting timing info
2021-10-06 11:00:27.067622 (Thread-2): Finished running node model.my_new_project.actors
2021-10-06 11:00:27.068721 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-10-06 11:00:27.071279 (Thread-2): Began running node model.my_new_project.luhn
2021-10-06 11:00:27.077137 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c48642-09d9-4f98-af0c-6ba4039f21a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096e274160>]}
2021-10-06 11:00:27.082849 (Thread-2): 11:00:27 | 3 of 4 START view model public.luhn.................................. [RUN]
2021-10-06 11:00:27.089886 (Thread-1): 11:00:27 | 1 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.67s]
2021-10-06 11:00:27.092093 (Thread-2): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-06 11:00:27.093497 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-10-06 11:00:27.096146 (Thread-2): Compiling model.my_new_project.luhn
2021-10-06 11:00:27.115976 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-10-06 11:00:27.125701 (Thread-1): 11:00:27 | 4 of 4 START view model public.my_second_dbt_model................... [RUN]
2021-10-06 11:00:27.138896 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:00:27.151090 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-10-06 11:00:27.170481 (Thread-2): Writing injected SQL for node "model.my_new_project.luhn"
2021-10-06 11:00:27.199129 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-06 11:00:27.203601 (Thread-2): finished collecting timing info
2021-10-06 11:00:27.231765 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:00:27.232396 (Thread-1): finished collecting timing info
2021-10-06 11:00:27.233290 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_tmp" cascade
2021-10-06 11:00:27.251609 (Thread-2): Opening a new connection, currently in state closed
2021-10-06 11:00:27.267925 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:00:27.269021 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_tmp" cascade
2021-10-06 11:00:27.270267 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:00:27.272678 (Thread-2): SQL status: DROP VIEW in 0.02 seconds
2021-10-06 11:00:27.280710 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:00:27.281777 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_backup" cascade
2021-10-06 11:00:27.282437 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:00:27.283485 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:00:27.291314 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:00:27.294855 (Thread-2): Writing runtime SQL for node "model.my_new_project.luhn"
2021-10-06 11:00:27.296052 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-06 11:00:27.298577 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:00:27.302620 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-06 11:00:27.313508 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:00:27.314438 (Thread-2): On model.my_new_project.luhn: BEGIN
2021-10-06 11:00:27.315970 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:00:27.317385 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:00:27.318564 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */

  create view "dellstore"."public"."luhn__dbt_tmp" as (
    CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean AS $$
-- Take the sum of the
-- doubled digits and the even-numbered undoubled digits, and see if
-- the sum is evenly divisible by zero.
SELECT
         -- Doubled digits might in turn be two digits. In that case,
         -- we must add each digit individually rather than adding the
         -- doubled digit value to the sum. Ie if the original digit was
         -- `6' the doubled result was `12' and we must add `1+2' to the
         -- sum rather than `12'.
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
FROM
-- Double odd-numbered digits (counting left with
-- least significant as zero). If the doubled digits end up
-- having values
-- > 10 (ie they're two digits), add their digits together.
(SELECT
         -- Extract digit `n' counting left from least significant
         -- as zero
         MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
         -- Double odd-numbered digits
         * (MOD(n,2) + 1)
         AS doubled_digit
         FROM generate_series(0, floor(log( $1 ))::integer) AS n
) AS doubled_digits;

$$ LANGUAGE sql
IMMUTABLE
STRICT;



SELECT 
SUM(ord.totalamount) as lostamount,
ord.orderdate as date
FROM
(SELECT totalamount, customerid, orderdate FROM "dellstore"."public"."orders" ) ord
JOIN
(SELECT customerid, creditcard FROM "dellstore"."public"."customers" 
)cust
ON ord.customerid = cust.customerid
WHERE luhn_verify(cust.creditcard::int8) = FALSE
GROUP BY date
ORDER BY date
  );

2021-10-06 11:00:27.320966 (Thread-2): Postgres error: syntax error at or near "CREATE"
LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
            ^

2021-10-06 11:00:27.322721 (Thread-2): On model.my_new_project.luhn: ROLLBACK
2021-10-06 11:00:27.326164 (Thread-2): finished collecting timing info
2021-10-06 11:00:27.329935 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:00:27.332137 (Thread-2): On model.my_new_project.luhn: Close
2021-10-06 11:00:27.333679 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-10-06 11:00:27.339436 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:00:27.341241 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:00:27.344013 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "dellstore"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dellstore"."public"."my_first_dbt_model"
where id = 1
  );

2021-10-06 11:00:27.353381 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 11:00:27.366319 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:00:27.367758 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "dellstore"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-10-06 11:00:27.370925 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:00:27.374915 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-06 11:00:27.336534 (Thread-2): Database Error in model luhn (models/luhn.sql)
  syntax error at or near "CREATE"
  LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
              ^
  compiled SQL at target/run/my_new_project/models/luhn.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "CREATE"
LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model luhn (models/luhn.sql)
  syntax error at or near "CREATE"
  LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
              ^
  compiled SQL at target/run/my_new_project/models/luhn.sql
2021-10-06 11:00:27.376395 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:00:27.377789 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c48642-09d9-4f98-af0c-6ba4039f21a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096e1fe8e0>]}
2021-10-06 11:00:27.378743 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-06 11:00:27.383294 (Thread-2): 11:00:27 | 3 of 4 ERROR creating view model public.luhn......................... [ERROR in 0.29s]
2021-10-06 11:00:27.385199 (Thread-2): Finished running node model.my_new_project.luhn
2021-10-06 11:00:27.387674 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:00:27.396181 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:00:27.397359 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-06 11:00:27.398819 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:00:27.406865 (Thread-1): finished collecting timing info
2021-10-06 11:00:27.408114 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-10-06 11:00:27.411307 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c48642-09d9-4f98-af0c-6ba4039f21a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096d8bc5e0>]}
2021-10-06 11:00:27.415582 (Thread-1): 11:00:27 | 4 of 4 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.27s]
2021-10-06 11:00:27.416680 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-10-06 11:00:27.422573 (MainThread): Acquiring new postgres connection "master".
2021-10-06 11:00:27.423944 (MainThread): Using postgres connection "master".
2021-10-06 11:00:27.424766 (MainThread): On master: BEGIN
2021-10-06 11:00:27.425705 (MainThread): Opening a new connection, currently in state closed
2021-10-06 11:00:27.435161 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:00:27.436296 (MainThread): On master: COMMIT
2021-10-06 11:00:27.437204 (MainThread): Using postgres connection "master".
2021-10-06 11:00:27.437988 (MainThread): On master: COMMIT
2021-10-06 11:00:27.440260 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:00:27.441390 (MainThread): On master: Close
2021-10-06 11:00:27.444169 (MainThread): 11:00:27 | 
2021-10-06 11:00:27.445894 (MainThread): 11:00:27 | Finished running 3 view models, 1 table model in 1.41s.
2021-10-06 11:00:27.447821 (MainThread): Connection 'master' was properly closed.
2021-10-06 11:00:27.449812 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-10-06 11:00:27.451013 (MainThread): Connection 'model.my_new_project.luhn' was properly closed.
2021-10-06 11:00:27.627628 (MainThread): 
2021-10-06 11:00:27.629082 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 11:00:27.630624 (MainThread): 
2021-10-06 11:00:27.632509 (MainThread): Database Error in model luhn (models/luhn.sql)
2021-10-06 11:00:27.634056 (MainThread):   syntax error at or near "CREATE"
2021-10-06 11:00:27.635641 (MainThread):   LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
2021-10-06 11:00:27.636998 (MainThread):               ^
2021-10-06 11:00:27.638976 (MainThread):   compiled SQL at target/run/my_new_project/models/luhn.sql
2021-10-06 11:00:27.640807 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-10-06 11:00:27.643025 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096d8bc5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096e1fc8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096e21ff70>]}
2021-10-06 11:00:27.645237 (MainThread): Flushing usage events
2021-10-06 11:01:14.967035 (MainThread): Running with dbt=0.19.0
2021-10-06 11:01:15.250618 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 11:01:15.256952 (MainThread): Tracking: tracking
2021-10-06 11:01:15.261499 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59e66a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a0115310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59e67b1c0>]}
2021-10-06 11:01:15.323786 (MainThread): Partial parsing not enabled
2021-10-06 11:01:15.330386 (MainThread): Parsing macros/adapters.sql
2021-10-06 11:01:15.387246 (MainThread): Parsing macros/catalog.sql
2021-10-06 11:01:15.394325 (MainThread): Parsing macros/relations.sql
2021-10-06 11:01:15.398826 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 11:01:15.406431 (MainThread): Parsing macros/core.sql
2021-10-06 11:01:15.419353 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 11:01:15.608217 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 11:01:15.614638 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 11:01:15.620402 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 11:01:15.643793 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 11:01:15.648989 (MainThread): Parsing macros/etc/query.sql
2021-10-06 11:01:15.652709 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 11:01:15.656135 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 11:01:15.691865 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 11:01:15.775338 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 11:01:15.780253 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 11:01:15.908440 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 11:01:15.953251 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 11:01:15.976251 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 11:01:15.984500 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 11:01:16.039010 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 11:01:16.056193 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 11:01:16.082934 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 11:01:16.113687 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 11:01:16.122066 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 11:01:16.128920 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 11:01:16.137231 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 11:01:16.181806 (MainThread): Partial parsing not enabled
2021-10-06 11:01:16.357045 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-06 11:01:16.443855 (MainThread): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-06 11:01:16.501033 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:01:16.590859 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:01:16.746485 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-06 11:01:17.667785 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7be8d53-133a-4da5-afdb-41157a043976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59e3d7f40>]}
2021-10-06 11:01:17.814014 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 11:01:17.817795 (MainThread): Found 4 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-06 11:01:17.822502 (MainThread): 
2021-10-06 11:01:17.825041 (MainThread): Acquiring new postgres connection "master".
2021-10-06 11:01:17.850923 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 11:01:17.891076 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 11:01:17.892181 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 11:01:17.893099 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 11:01:17.904907 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 11:01:17.913771 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 11:01:17.939504 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 11:01:17.960184 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 11:01:17.961370 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 11:01:17.962339 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 11:01:17.971942 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:01:17.973144 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 11:01:17.974161 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 11:01:17.981615 (ThreadPoolExecutor-1_0): SQL status: SELECT 12 in 0.01 seconds
2021-10-06 11:01:18.016480 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 11:01:18.018112 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 11:01:18.055609 (MainThread): Using postgres connection "master".
2021-10-06 11:01:18.056749 (MainThread): On master: BEGIN
2021-10-06 11:01:18.057758 (MainThread): Opening a new connection, currently in state init
2021-10-06 11:01:18.066343 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:01:18.067382 (MainThread): Using postgres connection "master".
2021-10-06 11:01:18.068639 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 11:01:18.083891 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 11:01:18.093676 (MainThread): On master: ROLLBACK
2021-10-06 11:01:18.095270 (MainThread): Using postgres connection "master".
2021-10-06 11:01:18.096159 (MainThread): On master: BEGIN
2021-10-06 11:01:18.098666 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:01:18.099882 (MainThread): On master: COMMIT
2021-10-06 11:01:18.101480 (MainThread): Using postgres connection "master".
2021-10-06 11:01:18.103317 (MainThread): On master: COMMIT
2021-10-06 11:01:18.105960 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:01:18.107582 (MainThread): On master: Close
2021-10-06 11:01:18.110609 (MainThread): 11:01:18 | Concurrency: 2 threads (target='dev')
2021-10-06 11:01:18.112306 (MainThread): 11:01:18 | 
2021-10-06 11:01:18.129916 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-10-06 11:01:18.130624 (Thread-2): Began running node model.my_new_project.actors
2021-10-06 11:01:18.135830 (Thread-1): 11:01:18 | 1 of 4 START table model public.my_first_dbt_model................... [RUN]
2021-10-06 11:01:18.141899 (Thread-2): 11:01:18 | 2 of 4 START view model public.actors................................ [RUN]
2021-10-06 11:01:18.145315 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:01:18.148492 (Thread-2): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-06 11:01:18.150964 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-10-06 11:01:18.153350 (Thread-2): Compiling model.my_new_project.actors
2021-10-06 11:01:18.289062 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-06 11:01:18.298588 (Thread-2): Writing injected SQL for node "model.my_new_project.actors"
2021-10-06 11:01:18.314893 (Thread-2): finished collecting timing info
2021-10-06 11:01:18.331018 (Thread-1): finished collecting timing info
2021-10-06 11:01:18.548797 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:01:18.550727 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:01:18.551536 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_tmp" cascade
2021-10-06 11:01:18.553081 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop view if exists "dellstore"."public"."actors__dbt_tmp" cascade
2021-10-06 11:01:18.554459 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:01:18.555847 (Thread-2): Opening a new connection, currently in state init
2021-10-06 11:01:18.568035 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 11:01:18.568753 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:01:18.580625 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:01:18.591803 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:01:18.592425 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-06 11:01:18.593789 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop view if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-06 11:01:18.596235 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 11:01:18.596816 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:01:18.638863 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-06 11:01:18.641353 (Thread-2): Writing runtime SQL for node "model.my_new_project.actors"
2021-10-06 11:01:18.658866 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:01:18.660036 (Thread-2): On model.my_new_project.actors: BEGIN
2021-10-06 11:01:18.661756 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:01:18.662861 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:01:18.663978 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */

  create view "dellstore"."public"."actors__dbt_tmp" as (
    -- dbt 
SELECT nested.first_name, nested.movie_number, nested.movie_prices FROM (
SELECT actor, SUBSTRING(actor, 1, POSITION(' ' in actor)) as first_name, 
actor, COUNT(*) as movie_number,
actor, SUM(price) as movie_prices
FROM "dellstore"."public"."products" 
GROUP BY actor
) nested

ORDER BY movie_prices DESC
  );

2021-10-06 11:01:18.665383 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:01:18.666270 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-10-06 11:01:18.667749 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:01:18.668896 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:01:18.670130 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "dellstore"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-10-06 11:01:18.670913 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 11:01:18.679593 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 11:01:18.694840 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:01:18.698901 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:01:18.699182 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors" rename to "actors__dbt_backup"
2021-10-06 11:01:18.700093 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-10-06 11:01:18.701867 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:01:18.702249 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:01:18.708915 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:01:18.713908 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:01:18.715097 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors__dbt_tmp" rename to "actors"
2021-10-06 11:01:18.716073 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-10-06 11:01:18.718061 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:01:18.718496 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:01:18.747984 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-06 11:01:18.748706 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-06 11:01:18.748936 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:01:18.749912 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:01:18.750754 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-06 11:01:18.751773 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-06 11:01:18.755397 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:01:18.762645 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-06 11:01:18.763959 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:01:18.768045 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:01:18.769058 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop view if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-06 11:01:18.769906 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-06 11:01:18.774441 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:01:18.780930 (Thread-2): finished collecting timing info
2021-10-06 11:01:18.781492 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 11:01:18.782155 (Thread-2): On model.my_new_project.actors: Close
2021-10-06 11:01:18.788620 (Thread-1): finished collecting timing info
2021-10-06 11:01:18.791396 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7be8d53-133a-4da5-afdb-41157a043976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59db8b3d0>]}
2021-10-06 11:01:18.791909 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-10-06 11:01:18.795090 (Thread-2): 11:01:18 | 2 of 4 OK created view model public.actors........................... [CREATE VIEW in 0.64s]
2021-10-06 11:01:18.797288 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7be8d53-133a-4da5-afdb-41157a043976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59e3e60a0>]}
2021-10-06 11:01:18.797864 (Thread-2): Finished running node model.my_new_project.actors
2021-10-06 11:01:18.801717 (Thread-1): 11:01:18 | 1 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.65s]
2021-10-06 11:01:18.802947 (Thread-2): Began running node model.my_new_project.luhn
2021-10-06 11:01:18.804171 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-10-06 11:01:18.809289 (Thread-2): 11:01:18 | 3 of 4 START view model public.luhn.................................. [RUN]
2021-10-06 11:01:18.813250 (Thread-2): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-06 11:01:18.814175 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-10-06 11:01:18.814875 (Thread-2): Compiling model.my_new_project.luhn
2021-10-06 11:01:18.819817 (Thread-1): 11:01:18 | 4 of 4 START view model public.my_second_dbt_model................... [RUN]
2021-10-06 11:01:18.832654 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:01:18.838699 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-10-06 11:01:18.858827 (Thread-2): Writing injected SQL for node "model.my_new_project.luhn"
2021-10-06 11:01:18.876111 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-06 11:01:18.884172 (Thread-2): finished collecting timing info
2021-10-06 11:01:18.903751 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:01:18.904852 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_tmp" cascade
2021-10-06 11:01:18.905389 (Thread-2): Opening a new connection, currently in state closed
2021-10-06 11:01:18.906733 (Thread-1): finished collecting timing info
2021-10-06 11:01:18.922214 (Thread-2): SQL status: DROP VIEW in 0.02 seconds
2021-10-06 11:01:18.925144 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:01:18.931225 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:01:18.931599 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_tmp" cascade
2021-10-06 11:01:18.932644 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_backup" cascade
2021-10-06 11:01:18.933562 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:01:18.935282 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:01:18.939473 (Thread-2): Writing runtime SQL for node "model.my_new_project.luhn"
2021-10-06 11:01:18.944023 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:01:18.952626 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:01:18.953548 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-06 11:01:18.955410 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:01:18.959953 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-06 11:01:18.963894 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:01:18.964774 (Thread-2): On model.my_new_project.luhn: BEGIN
2021-10-06 11:01:18.966231 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:01:18.967334 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:01:18.968588 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */

  create view "dellstore"."public"."luhn__dbt_tmp" as (
    SELECT 
SUM(ord.totalamount) as lostamount,
ord.orderdate as date
FROM
(SELECT totalamount, customerid, orderdate FROM "dellstore"."public"."orders" ) ord
JOIN
(SELECT customerid, creditcard FROM "dellstore"."public"."customers" 
)cust
ON ord.customerid = cust.customerid
WHERE luhn_verify(cust.creditcard::int8) = FALSE
GROUP BY date
ORDER BY date
  );

2021-10-06 11:01:18.976134 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:01:18.977357 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-10-06 11:01:18.979248 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:01:18.980417 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:01:18.981490 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "dellstore"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dellstore"."public"."my_first_dbt_model"
where id = 1
  );

2021-10-06 11:01:18.983633 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 11:01:18.992765 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 11:01:18.994856 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:01:19.003159 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:01:19.003609 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
alter table "dellstore"."public"."luhn__dbt_tmp" rename to "luhn"
2021-10-06 11:01:19.004738 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "dellstore"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-10-06 11:01:19.007193 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:01:19.007572 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:01:19.010905 (Thread-2): On model.my_new_project.luhn: COMMIT
2021-10-06 11:01:19.014429 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-06 11:01:19.015610 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:01:19.016683 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:01:19.017831 (Thread-2): On model.my_new_project.luhn: COMMIT
2021-10-06 11:01:19.018945 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-06 11:01:19.023605 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:01:19.030941 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-10-06 11:01:19.031984 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:01:19.038041 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:01:19.038717 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_backup" cascade
2021-10-06 11:01:19.039812 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-06 11:01:19.041719 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:01:19.042707 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:01:19.051082 (Thread-2): finished collecting timing info
2021-10-06 11:01:19.059583 (Thread-1): finished collecting timing info
2021-10-06 11:01:19.060924 (Thread-2): On model.my_new_project.luhn: Close
2021-10-06 11:01:19.062215 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-10-06 11:01:19.065148 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7be8d53-133a-4da5-afdb-41157a043976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59c2bfa30>]}
2021-10-06 11:01:19.067008 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7be8d53-133a-4da5-afdb-41157a043976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59c33c7f0>]}
2021-10-06 11:01:19.070920 (Thread-2): 11:01:19 | 3 of 4 OK created view model public.luhn............................. [CREATE VIEW in 0.25s]
2021-10-06 11:01:19.075475 (Thread-1): 11:01:19 | 4 of 4 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.23s]
2021-10-06 11:01:19.076871 (Thread-2): Finished running node model.my_new_project.luhn
2021-10-06 11:01:19.077730 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-10-06 11:01:19.084606 (MainThread): Acquiring new postgres connection "master".
2021-10-06 11:01:19.086057 (MainThread): Using postgres connection "master".
2021-10-06 11:01:19.087125 (MainThread): On master: BEGIN
2021-10-06 11:01:19.088208 (MainThread): Opening a new connection, currently in state closed
2021-10-06 11:01:19.098013 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:01:19.101326 (MainThread): On master: COMMIT
2021-10-06 11:01:19.102701 (MainThread): Using postgres connection "master".
2021-10-06 11:01:19.104006 (MainThread): On master: COMMIT
2021-10-06 11:01:19.106264 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:01:19.107917 (MainThread): On master: Close
2021-10-06 11:01:19.110143 (MainThread): 11:01:19 | 
2021-10-06 11:01:19.111338 (MainThread): 11:01:19 | Finished running 3 view models, 1 table model in 1.29s.
2021-10-06 11:01:19.112366 (MainThread): Connection 'master' was properly closed.
2021-10-06 11:01:19.113950 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-10-06 11:01:19.115315 (MainThread): Connection 'model.my_new_project.luhn' was properly closed.
2021-10-06 11:01:19.279245 (MainThread): 
2021-10-06 11:01:19.280357 (MainThread): Completed successfully
2021-10-06 11:01:19.281213 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-06 11:01:19.282446 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59c2c3f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59e426760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59e421760>]}
2021-10-06 11:01:19.284016 (MainThread): Flushing usage events
2021-10-06 11:02:15.640217 (MainThread): Running with dbt=0.19.0
2021-10-06 11:02:15.958605 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 11:02:15.966087 (MainThread): Tracking: tracking
2021-10-06 11:02:15.971659 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa1f46fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa554d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa1f57070>]}
2021-10-06 11:02:16.033966 (MainThread): Partial parsing not enabled
2021-10-06 11:02:16.040982 (MainThread): Parsing macros/adapters.sql
2021-10-06 11:02:16.113347 (MainThread): Parsing macros/catalog.sql
2021-10-06 11:02:16.126164 (MainThread): Parsing macros/relations.sql
2021-10-06 11:02:16.135016 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 11:02:16.149404 (MainThread): Parsing macros/core.sql
2021-10-06 11:02:16.174223 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 11:02:16.337239 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 11:02:16.343427 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 11:02:16.349574 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 11:02:16.386152 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 11:02:16.392495 (MainThread): Parsing macros/etc/query.sql
2021-10-06 11:02:16.396817 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 11:02:16.400527 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 11:02:16.435338 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 11:02:16.520064 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 11:02:16.528090 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 11:02:16.659189 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 11:02:16.732715 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 11:02:16.756933 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 11:02:16.765320 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 11:02:16.834543 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 11:02:16.857322 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 11:02:16.889935 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 11:02:16.929247 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 11:02:16.940053 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 11:02:16.948619 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 11:02:16.959550 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 11:02:17.015868 (MainThread): Partial parsing not enabled
2021-10-06 11:02:17.162651 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-06 11:02:17.262854 (MainThread): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-06 11:02:17.327151 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:02:17.412503 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:02:17.507085 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-06 11:02:18.603142 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82107684-24d3-4d2d-a315-d780267ef7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa1cb2c40>]}
2021-10-06 11:02:18.793332 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 11:02:18.798862 (MainThread): Found 4 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-06 11:02:18.812959 (MainThread): 
2021-10-06 11:02:18.816573 (MainThread): Acquiring new postgres connection "master".
2021-10-06 11:02:18.865574 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 11:02:18.937458 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 11:02:18.939017 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 11:02:18.940444 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 11:02:18.958943 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.02 seconds
2021-10-06 11:02:18.974599 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 11:02:19.019752 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 11:02:19.053647 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 11:02:19.055064 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 11:02:19.056277 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 11:02:19.070201 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:02:19.072850 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 11:02:19.076028 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 11:02:19.088594 (ThreadPoolExecutor-1_0): SQL status: SELECT 13 in 0.01 seconds
2021-10-06 11:02:19.160416 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 11:02:19.162934 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 11:02:19.225887 (MainThread): Using postgres connection "master".
2021-10-06 11:02:19.227482 (MainThread): On master: BEGIN
2021-10-06 11:02:19.228990 (MainThread): Opening a new connection, currently in state init
2021-10-06 11:02:19.243277 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:02:19.245297 (MainThread): Using postgres connection "master".
2021-10-06 11:02:19.246939 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 11:02:19.274823 (MainThread): SQL status: SELECT 4 in 0.03 seconds
2021-10-06 11:02:19.304708 (MainThread): On master: ROLLBACK
2021-10-06 11:02:19.307267 (MainThread): Using postgres connection "master".
2021-10-06 11:02:19.308732 (MainThread): On master: BEGIN
2021-10-06 11:02:19.311695 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:02:19.314045 (MainThread): On master: COMMIT
2021-10-06 11:02:19.316082 (MainThread): Using postgres connection "master".
2021-10-06 11:02:19.317863 (MainThread): On master: COMMIT
2021-10-06 11:02:19.321097 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:02:19.323669 (MainThread): On master: Close
2021-10-06 11:02:19.326368 (MainThread): 11:02:19 | Concurrency: 2 threads (target='dev')
2021-10-06 11:02:19.328014 (MainThread): 11:02:19 | 
2021-10-06 11:02:19.351548 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-10-06 11:02:19.353006 (Thread-2): Began running node model.my_new_project.actors
2021-10-06 11:02:19.364226 (Thread-1): 11:02:19 | 1 of 4 START table model public.my_first_dbt_model................... [RUN]
2021-10-06 11:02:19.379125 (Thread-2): 11:02:19 | 2 of 4 START view model public.actors................................ [RUN]
2021-10-06 11:02:19.381965 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:02:19.395147 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-10-06 11:02:19.397298 (Thread-2): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-06 11:02:19.411569 (Thread-2): Compiling model.my_new_project.actors
2021-10-06 11:02:19.542689 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-06 11:02:19.544725 (Thread-2): Writing injected SQL for node "model.my_new_project.actors"
2021-10-06 11:02:19.554416 (Thread-2): finished collecting timing info
2021-10-06 11:02:19.562398 (Thread-1): finished collecting timing info
2021-10-06 11:02:19.732843 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:02:19.740508 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_tmp" cascade
2021-10-06 11:02:19.745748 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:02:19.746499 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:02:19.748673 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop view if exists "dellstore"."public"."actors__dbt_tmp" cascade
2021-10-06 11:02:19.753383 (Thread-2): Opening a new connection, currently in state init
2021-10-06 11:02:19.765997 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-10-06 11:02:19.774912 (Thread-2): SQL status: DROP VIEW in 0.02 seconds
2021-10-06 11:02:19.789625 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:02:19.797411 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-06 11:02:19.799619 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:02:19.801599 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop view if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-06 11:02:19.802524 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 11:02:19.804698 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:02:19.860609 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-06 11:02:19.865190 (Thread-2): Writing runtime SQL for node "model.my_new_project.actors"
2021-10-06 11:02:19.890141 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:02:19.892367 (Thread-2): On model.my_new_project.actors: BEGIN
2021-10-06 11:02:19.895072 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:02:19.897161 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:02:19.899433 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */

  create view "dellstore"."public"."actors__dbt_tmp" as (
    -- dbt 
SELECT nested.first_name, nested.movie_number, nested.movie_prices FROM (
SELECT actor, SUBSTRING(actor, 1, POSITION(' ' in actor)) as first_name, 
actor, COUNT(*) as movie_number,
actor, SUM(price) as movie_prices
FROM "dellstore"."public"."products" 
GROUP BY actor
) nested

ORDER BY movie_prices DESC
  );

2021-10-06 11:02:19.901703 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:02:19.906070 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-10-06 11:02:19.909311 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:02:19.912028 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:02:19.914196 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "dellstore"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-10-06 11:02:19.917861 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 11:02:19.930720 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 11:02:20.013411 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:02:20.015667 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:02:20.016483 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors" rename to "actors__dbt_backup"
2021-10-06 11:02:20.018792 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-10-06 11:02:20.023371 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:02:20.023971 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:02:20.044614 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:02:20.051826 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors__dbt_tmp" rename to "actors"
2021-10-06 11:02:20.055846 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:02:20.057818 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-10-06 11:02:20.058798 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:02:20.071637 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-10-06 11:02:20.133419 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-06 11:02:20.136015 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-06 11:02:20.136682 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:02:20.138996 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:02:20.140734 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-06 11:02:20.142546 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-06 11:02:20.148103 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:02:20.161390 (Thread-2): SQL status: COMMIT in 0.02 seconds
2021-10-06 11:02:20.175785 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:02:20.179984 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:02:20.181625 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-06 11:02:20.183477 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop view if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-06 11:02:20.191586 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:02:20.200753 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-10-06 11:02:20.214267 (Thread-2): finished collecting timing info
2021-10-06 11:02:20.222962 (Thread-1): finished collecting timing info
2021-10-06 11:02:20.224603 (Thread-2): On model.my_new_project.actors: Close
2021-10-06 11:02:20.226290 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-10-06 11:02:20.231465 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82107684-24d3-4d2d-a315-d780267ef7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa1434f10>]}
2021-10-06 11:02:20.235099 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82107684-24d3-4d2d-a315-d780267ef7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa1debd60>]}
2021-10-06 11:02:20.244103 (Thread-2): 11:02:20 | 2 of 4 OK created view model public.actors........................... [CREATE VIEW in 0.84s]
2021-10-06 11:02:20.253488 (Thread-1): 11:02:20 | 1 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.85s]
2021-10-06 11:02:20.256506 (Thread-2): Finished running node model.my_new_project.actors
2021-10-06 11:02:20.259437 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-10-06 11:02:20.261710 (Thread-2): Began running node model.my_new_project.luhn
2021-10-06 11:02:20.277204 (Thread-2): 11:02:20 | 3 of 4 START view model public.luhn.................................. [RUN]
2021-10-06 11:02:20.278216 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-10-06 11:02:20.284357 (Thread-2): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-06 11:02:20.293300 (Thread-1): 11:02:20 | 4 of 4 START view model public.my_second_dbt_model................... [RUN]
2021-10-06 11:02:20.294191 (Thread-2): Compiling model.my_new_project.luhn
2021-10-06 11:02:20.299542 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:02:20.315065 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-10-06 11:02:20.348355 (Thread-2): Writing injected SQL for node "model.my_new_project.luhn"
2021-10-06 11:02:20.357415 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-06 11:02:20.364278 (Thread-2): finished collecting timing info
2021-10-06 11:02:20.386174 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:02:20.386784 (Thread-1): finished collecting timing info
2021-10-06 11:02:20.387929 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_tmp" cascade
2021-10-06 11:02:20.399876 (Thread-2): Opening a new connection, currently in state closed
2021-10-06 11:02:20.407797 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:02:20.408473 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_tmp" cascade
2021-10-06 11:02:20.409004 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:02:20.411840 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:02:20.418080 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:02:20.418825 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_backup" cascade
2021-10-06 11:02:20.419402 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:02:20.420276 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:02:20.428883 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:02:20.431533 (Thread-2): Writing runtime SQL for node "model.my_new_project.luhn"
2021-10-06 11:02:20.432352 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-06 11:02:20.434431 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:02:20.437764 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-06 11:02:20.446984 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:02:20.447729 (Thread-2): On model.my_new_project.luhn: BEGIN
2021-10-06 11:02:20.449125 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:02:20.450334 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:02:20.451213 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */

  create view "dellstore"."public"."luhn__dbt_tmp" as (
    SELECT 
SUM(ord.totalamount) as lostamount,
ord.orderdate as date
FROM
(SELECT totalamount, customerid, orderdate FROM "dellstore"."public"."orders" ) ord
JOIN
(SELECT customerid, creditcard FROM "dellstore"."public"."customers" 
)cust
ON ord.customerid = cust.customerid
WHERE luhn_verify(cust.creditcard::int8) = FALSE
GROUP BY date
ORDER BY date
  );

2021-10-06 11:02:20.452448 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:02:20.453279 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-10-06 11:02:20.454450 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:02:20.455307 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:02:20.456161 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "dellstore"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dellstore"."public"."my_first_dbt_model"
where id = 1
  );

2021-10-06 11:02:20.458659 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 11:02:20.471133 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 11:02:20.473126 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:02:20.480832 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:02:20.481246 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
alter table "dellstore"."public"."luhn" rename to "luhn__dbt_backup"
2021-10-06 11:02:20.482054 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "dellstore"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-10-06 11:02:20.484124 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:02:20.484534 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:02:20.491345 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:02:20.493827 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-06 11:02:20.494691 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
alter table "dellstore"."public"."luhn__dbt_tmp" rename to "luhn"
2021-10-06 11:02:20.495507 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:02:20.496605 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-06 11:02:20.497247 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:02:20.501380 (Thread-2): On model.my_new_project.luhn: COMMIT
2021-10-06 11:02:20.501743 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:02:20.502249 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:02:20.506708 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:02:20.507539 (Thread-2): On model.my_new_project.luhn: COMMIT
2021-10-06 11:02:20.508223 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-06 11:02:20.510027 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:02:20.518217 (Thread-1): finished collecting timing info
2021-10-06 11:02:20.519178 (Thread-2): SQL status: COMMIT in 0.01 seconds
2021-10-06 11:02:20.522026 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-10-06 11:02:20.556325 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:02:20.557923 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82107684-24d3-4d2d-a315-d780267ef7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa1434b20>]}
2021-10-06 11:02:20.558214 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_backup" cascade
2021-10-06 11:02:20.561566 (Thread-1): 11:02:20 | 4 of 4 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.26s]
2021-10-06 11:02:20.563276 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-10-06 11:02:20.567237 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:02:20.577108 (Thread-2): finished collecting timing info
2021-10-06 11:02:20.578451 (Thread-2): On model.my_new_project.luhn: Close
2021-10-06 11:02:20.580386 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82107684-24d3-4d2d-a315-d780267ef7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa03eb7c0>]}
2021-10-06 11:02:20.584749 (Thread-2): 11:02:20 | 3 of 4 OK created view model public.luhn............................. [CREATE VIEW in 0.30s]
2021-10-06 11:02:20.585680 (Thread-2): Finished running node model.my_new_project.luhn
2021-10-06 11:02:20.590540 (MainThread): Acquiring new postgres connection "master".
2021-10-06 11:02:20.591336 (MainThread): Using postgres connection "master".
2021-10-06 11:02:20.592147 (MainThread): On master: BEGIN
2021-10-06 11:02:20.592762 (MainThread): Opening a new connection, currently in state closed
2021-10-06 11:02:20.599577 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:02:20.600860 (MainThread): On master: COMMIT
2021-10-06 11:02:20.601752 (MainThread): Using postgres connection "master".
2021-10-06 11:02:20.602468 (MainThread): On master: COMMIT
2021-10-06 11:02:20.603541 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:02:20.604332 (MainThread): On master: Close
2021-10-06 11:02:20.605708 (MainThread): 11:02:20 | 
2021-10-06 11:02:20.606734 (MainThread): 11:02:20 | Finished running 3 view models, 1 table model in 1.79s.
2021-10-06 11:02:20.607447 (MainThread): Connection 'master' was properly closed.
2021-10-06 11:02:20.608241 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-10-06 11:02:20.609049 (MainThread): Connection 'model.my_new_project.luhn' was properly closed.
2021-10-06 11:02:20.738698 (MainThread): 
2021-10-06 11:02:20.739793 (MainThread): Completed successfully
2021-10-06 11:02:20.740870 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-06 11:02:20.742519 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa1e40dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa1d848b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa1da0100>]}
2021-10-06 11:02:20.744609 (MainThread): Flushing usage events
2021-10-06 11:03:20.364175 (MainThread): Running with dbt=0.19.0
2021-10-06 11:03:20.631955 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 11:03:20.639502 (MainThread): Tracking: tracking
2021-10-06 11:03:20.645043 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c6ac4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ca0ca460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c6ad4130>]}
2021-10-06 11:03:20.721054 (MainThread): Partial parsing not enabled
2021-10-06 11:03:20.728179 (MainThread): Parsing macros/adapters.sql
2021-10-06 11:03:20.818654 (MainThread): Parsing macros/catalog.sql
2021-10-06 11:03:20.830454 (MainThread): Parsing macros/relations.sql
2021-10-06 11:03:20.838484 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 11:03:20.849408 (MainThread): Parsing macros/core.sql
2021-10-06 11:03:20.868563 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 11:03:21.134479 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 11:03:21.141354 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 11:03:21.147750 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 11:03:21.191011 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 11:03:21.198528 (MainThread): Parsing macros/etc/query.sql
2021-10-06 11:03:21.203606 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 11:03:21.208349 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 11:03:21.255643 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 11:03:21.332019 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 11:03:21.337508 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 11:03:21.428605 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 11:03:21.497059 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 11:03:21.526106 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 11:03:21.534920 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 11:03:21.601692 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 11:03:21.615895 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 11:03:21.641222 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 11:03:21.671948 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 11:03:21.679853 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 11:03:21.686353 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 11:03:21.694608 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 11:03:21.738410 (MainThread): Partial parsing not enabled
2021-10-06 11:03:21.893476 (MainThread): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-06 11:03:22.054368 (MainThread): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-06 11:03:22.167585 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:03:22.272093 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:03:22.475689 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.actors_snapshot".
2021-10-06 11:03:23.380560 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4bac902-4afb-45ac-afb3-d86b27b210c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c689cc40>]}
2021-10-06 11:03:23.517404 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 11:03:23.520489 (MainThread): Found 4 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2021-10-06 11:03:23.523492 (MainThread): 
2021-10-06 11:03:23.524977 (MainThread): Acquiring new postgres connection "master".
2021-10-06 11:03:23.539913 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 11:03:23.568471 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 11:03:23.569555 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 11:03:23.570509 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 11:03:23.578410 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 11:03:23.585250 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 11:03:23.608241 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 11:03:23.629479 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 11:03:23.630688 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 11:03:23.631832 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 11:03:23.640560 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:03:23.641841 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 11:03:23.643036 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 11:03:23.651082 (ThreadPoolExecutor-1_0): SQL status: SELECT 13 in 0.01 seconds
2021-10-06 11:03:23.689542 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 11:03:23.691091 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 11:03:23.728571 (MainThread): Using postgres connection "master".
2021-10-06 11:03:23.729565 (MainThread): On master: BEGIN
2021-10-06 11:03:23.730555 (MainThread): Opening a new connection, currently in state init
2021-10-06 11:03:23.738804 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:03:23.740165 (MainThread): Using postgres connection "master".
2021-10-06 11:03:23.741567 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 11:03:23.758188 (MainThread): SQL status: SELECT 4 in 0.02 seconds
2021-10-06 11:03:23.776113 (MainThread): On master: ROLLBACK
2021-10-06 11:03:23.777827 (MainThread): Using postgres connection "master".
2021-10-06 11:03:23.778830 (MainThread): On master: BEGIN
2021-10-06 11:03:23.780801 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:03:23.781842 (MainThread): On master: COMMIT
2021-10-06 11:03:23.782955 (MainThread): Using postgres connection "master".
2021-10-06 11:03:23.783904 (MainThread): On master: COMMIT
2021-10-06 11:03:23.785877 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:03:23.786915 (MainThread): On master: Close
2021-10-06 11:03:23.788843 (MainThread): 11:03:23 | Concurrency: 2 threads (target='dev')
2021-10-06 11:03:23.790194 (MainThread): 11:03:23 | 
2021-10-06 11:03:23.801465 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-10-06 11:03:23.802049 (Thread-2): Began running node model.my_new_project.actors
2021-10-06 11:03:23.806719 (Thread-1): 11:03:23 | 1 of 4 START table model public.my_first_dbt_model................... [RUN]
2021-10-06 11:03:23.810926 (Thread-2): 11:03:23 | 2 of 4 START view model public.actors................................ [RUN]
2021-10-06 11:03:23.813095 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:03:23.816524 (Thread-2): Acquiring new postgres connection "model.my_new_project.actors".
2021-10-06 11:03:23.817461 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-10-06 11:03:23.819066 (Thread-2): Compiling model.my_new_project.actors
2021-10-06 11:03:23.910683 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-06 11:03:23.916476 (Thread-2): Writing injected SQL for node "model.my_new_project.actors"
2021-10-06 11:03:23.931073 (Thread-2): finished collecting timing info
2021-10-06 11:03:23.947264 (Thread-1): finished collecting timing info
2021-10-06 11:03:24.113494 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:03:24.113972 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:03:24.114773 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_tmp" cascade
2021-10-06 11:03:24.115783 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop view if exists "dellstore"."public"."actors__dbt_tmp" cascade
2021-10-06 11:03:24.116824 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:03:24.117851 (Thread-2): Opening a new connection, currently in state init
2021-10-06 11:03:24.126975 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:03:24.135912 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:03:24.136354 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-10-06 11:03:24.137020 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop view if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-06 11:03:24.145451 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:03:24.146808 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:03:24.147287 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-06 11:03:24.164387 (Thread-2): Writing runtime SQL for node "model.my_new_project.actors"
2021-10-06 11:03:24.164967 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 11:03:24.186699 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-10-06 11:03:24.190266 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:03:24.191292 (Thread-2): On model.my_new_project.actors: BEGIN
2021-10-06 11:03:24.193017 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:03:24.194376 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:03:24.195580 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */

  create view "dellstore"."public"."actors__dbt_tmp" as (
    -- dbt 
SELECT nested.first_name, nested.movie_number, nested.movie_prices FROM (
SELECT actor, SUBSTRING(actor, 1, POSITION(' ' in actor)) as first_name, 
actor, COUNT(*) as movie_number,
actor, SUM(price) as movie_prices
FROM "dellstore"."public"."products" 
GROUP BY actor
) nested

ORDER BY movie_prices DESC
  );

2021-10-06 11:03:24.204369 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 11:03:24.214100 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:03:24.220516 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-10-06 11:03:24.232771 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-10-06 11:03:24.239271 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:03:24.240067 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:03:24.241451 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "dellstore"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-10-06 11:03:24.242841 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors" rename to "actors__dbt_backup"
2021-10-06 11:03:24.247506 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:03:24.255164 (Thread-1): SQL status: SELECT 2 in 0.01 seconds
2021-10-06 11:03:24.257744 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:03:24.269538 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
alter table "dellstore"."public"."actors__dbt_tmp" rename to "actors"
2021-10-06 11:03:24.285000 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:03:24.285552 (Thread-2): SQL status: ALTER TABLE in 0.01 seconds
2021-10-06 11:03:24.286236 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-10-06 11:03:24.330591 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-10-06 11:03:24.351425 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:03:24.352861 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-06 11:03:24.353334 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "dellstore"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-10-06 11:03:24.354523 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:03:24.356701 (Thread-2): On model.my_new_project.actors: COMMIT
2021-10-06 11:03:24.357363 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:03:24.361448 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-06 11:03:24.361930 (Thread-2): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:03:24.362565 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:03:24.374787 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-10-06 11:03:24.379667 (Thread-2): Using postgres connection "model.my_new_project.actors".
2021-10-06 11:03:24.381416 (Thread-2): On model.my_new_project.actors: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.actors"} */
drop view if exists "dellstore"."public"."actors__dbt_backup" cascade
2021-10-06 11:03:24.383549 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:03:24.390753 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2021-10-06 11:03:24.391236 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:03:24.391926 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "dellstore"."public"."my_first_dbt_model__dbt_backup" cascade
2021-10-06 11:03:24.402388 (Thread-2): finished collecting timing info
2021-10-06 11:03:24.404680 (Thread-2): On model.my_new_project.actors: Close
2021-10-06 11:03:24.408175 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bac902-4afb-45ac-afb3-d86b27b210c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c5fb0fa0>]}
2021-10-06 11:03:24.414876 (Thread-2): 11:03:24 | 2 of 4 OK created view model public.actors........................... [CREATE VIEW in 0.59s]
2021-10-06 11:03:24.415537 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 11:03:24.417441 (Thread-2): Finished running node model.my_new_project.actors
2021-10-06 11:03:24.433317 (Thread-2): Began running node model.my_new_project.luhn
2021-10-06 11:03:24.445044 (Thread-2): 11:03:24 | 3 of 4 START view model public.luhn.................................. [RUN]
2021-10-06 11:03:24.446608 (Thread-1): finished collecting timing info
2021-10-06 11:03:24.450263 (Thread-2): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-06 11:03:24.451527 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-10-06 11:03:24.453752 (Thread-2): Compiling model.my_new_project.luhn
2021-10-06 11:03:24.457616 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bac902-4afb-45ac-afb3-d86b27b210c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c5fb0d90>]}
2021-10-06 11:03:24.473474 (Thread-1): 11:03:24 | 1 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.64s]
2021-10-06 11:03:24.490668 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-10-06 11:03:24.503502 (Thread-2): Writing injected SQL for node "model.my_new_project.luhn"
2021-10-06 11:03:24.504392 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-10-06 11:03:24.509296 (Thread-1): 11:03:24 | 4 of 4 START view model public.my_second_dbt_model................... [RUN]
2021-10-06 11:03:24.510932 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:03:24.512108 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-10-06 11:03:24.546515 (Thread-2): finished collecting timing info
2021-10-06 11:03:24.546184 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-06 11:03:24.575592 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:03:24.576469 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_tmp" cascade
2021-10-06 11:03:24.577187 (Thread-2): Opening a new connection, currently in state closed
2021-10-06 11:03:24.586273 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:03:24.592929 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:03:24.593384 (Thread-1): finished collecting timing info
2021-10-06 11:03:24.594107 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_backup" cascade
2021-10-06 11:03:24.612760 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:03:24.618035 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:03:24.621215 (Thread-2): Writing runtime SQL for node "model.my_new_project.luhn"
2021-10-06 11:03:24.622269 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_tmp" cascade
2021-10-06 11:03:24.623848 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:03:24.632127 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:03:24.639337 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:03:24.640375 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-06 11:03:24.642255 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:03:24.649749 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:03:24.650737 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-10-06 11:03:24.651112 (Thread-2): On model.my_new_project.luhn: BEGIN
2021-10-06 11:03:24.653881 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:03:24.655312 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:03:24.657296 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */

  create view "dellstore"."public"."luhn__dbt_tmp" as (
    -- CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean AS $$
-- -- Take the sum of the
-- -- doubled digits and the even-numbered undoubled digits, and see if
-- -- the sum is evenly divisible by zero.
-- SELECT
--          -- Doubled digits might in turn be two digits. In that case,
--          -- we must add each digit individually rather than adding the
--          -- doubled digit value to the sum. Ie if the original digit was
--          -- `6' the doubled result was `12' and we must add `1+2' to the
--          -- sum rather than `12'.
--          MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
-- FROM
-- -- Double odd-numbered digits (counting left with
-- -- least significant as zero). If the doubled digits end up
-- -- having values
-- -- > 10 (ie they're two digits), add their digits together.
-- (SELECT
--          -- Extract digit `n' counting left from least significant
--          -- as zero
--          MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
--          -- Double odd-numbered digits
--          * (MOD(n,2) + 1)
--          AS doubled_digit
--          FROM generate_series(0, floor(log( $1 ))::integer) AS n
-- ) AS doubled_digits;

-- $$ LANGUAGE sql
-- IMMUTABLE
-- STRICT;



SELECT 
SUM(ord.totalamount) as lostamount,
ord.orderdate as date
FROM
(SELECT totalamount, customerid, orderdate FROM "dellstore"."public"."orders" ) ord
JOIN
(SELECT customerid, creditcard FROM "dellstore"."public"."customers" 
)cust
ON ord.customerid = cust.customerid
WHERE luhn_verify(cust.creditcard::int8) = FALSE
GROUP BY date
ORDER BY date
  );

2021-10-06 11:03:24.669851 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 11:03:24.683912 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:03:24.685180 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
alter table "dellstore"."public"."luhn" rename to "luhn__dbt_backup"
2021-10-06 11:03:24.688441 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:03:24.688880 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:03:24.689779 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-10-06 11:03:24.698901 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:03:24.700088 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 11:03:24.700647 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
alter table "dellstore"."public"."luhn__dbt_tmp" rename to "luhn"
2021-10-06 11:03:24.701786 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:03:24.703818 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "dellstore"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dellstore"."public"."my_first_dbt_model"
where id = 1
  );

2021-10-06 11:03:24.705409 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:03:24.710234 (Thread-2): On model.my_new_project.luhn: COMMIT
2021-10-06 11:03:24.710886 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-10-06 11:03:24.711460 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:03:24.720559 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:03:24.721023 (Thread-2): On model.my_new_project.luhn: COMMIT
2021-10-06 11:03:24.721884 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "dellstore"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-10-06 11:03:24.724393 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 11:03:24.727963 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-06 11:03:24.728432 (Thread-2): SQL status: COMMIT in 0.01 seconds
2021-10-06 11:03:24.728967 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:03:24.736356 (Thread-2): Using postgres connection "model.my_new_project.luhn".
2021-10-06 11:03:24.736778 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-10-06 11:03:24.737701 (Thread-2): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_backup" cascade
2021-10-06 11:03:24.741064 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:03:24.747271 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2021-10-06 11:03:24.747804 (Thread-2): SQL status: DROP VIEW in 0.01 seconds
2021-10-06 11:03:24.748601 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "dellstore"."public"."my_second_dbt_model__dbt_backup" cascade
2021-10-06 11:03:24.759628 (Thread-2): finished collecting timing info
2021-10-06 11:03:24.762522 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-06 11:03:24.763732 (Thread-2): On model.my_new_project.luhn: Close
2021-10-06 11:03:24.781420 (Thread-1): finished collecting timing info
2021-10-06 11:03:24.787307 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bac902-4afb-45ac-afb3-d86b27b210c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c69fb520>]}
2021-10-06 11:03:24.788214 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-10-06 11:03:24.796962 (Thread-2): 11:03:24 | 3 of 4 OK created view model public.luhn............................. [CREATE VIEW in 0.34s]
2021-10-06 11:03:24.801236 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4bac902-4afb-45ac-afb3-d86b27b210c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c472fdc0>]}
2021-10-06 11:03:24.802585 (Thread-2): Finished running node model.my_new_project.luhn
2021-10-06 11:03:24.821212 (Thread-1): 11:03:24 | 4 of 4 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.29s]
2021-10-06 11:03:24.823518 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-10-06 11:03:24.838125 (MainThread): Acquiring new postgres connection "master".
2021-10-06 11:03:24.841297 (MainThread): Using postgres connection "master".
2021-10-06 11:03:24.843324 (MainThread): On master: BEGIN
2021-10-06 11:03:24.845235 (MainThread): Opening a new connection, currently in state closed
2021-10-06 11:03:24.862669 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-10-06 11:03:24.865531 (MainThread): On master: COMMIT
2021-10-06 11:03:24.869248 (MainThread): Using postgres connection "master".
2021-10-06 11:03:24.872223 (MainThread): On master: COMMIT
2021-10-06 11:03:24.877022 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 11:03:24.879353 (MainThread): On master: Close
2021-10-06 11:03:24.884045 (MainThread): 11:03:24 | 
2021-10-06 11:03:24.886742 (MainThread): 11:03:24 | Finished running 3 view models, 1 table model in 1.36s.
2021-10-06 11:03:24.889760 (MainThread): Connection 'master' was properly closed.
2021-10-06 11:03:24.892343 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-10-06 11:03:24.895312 (MainThread): Connection 'model.my_new_project.luhn' was properly closed.
2021-10-06 11:03:25.249540 (MainThread): 
2021-10-06 11:03:25.250214 (MainThread): Completed successfully
2021-10-06 11:03:25.251048 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-06 11:03:25.252687 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c69fb520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c691e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c683d400>]}
2021-10-06 11:03:25.254348 (MainThread): Flushing usage events
